import{$ as xc,$b as Lc,Ca as kt,Ka as Vc,a as Dc,ac as Mc,b as kc,d as Fe,da as mr,e as h,ea as Rt,ga as Pt,h as pn,hb as Ue,ia as Ct,ka as ue,n as Nc,o as Oc,oa as Dt,q as Ji,r as Yi,s as Xi}from"./chunk-JDG5T4L5.js";var Uc=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Kd=function(t){let e=[],n=0,r=0;for(;n<t.length;){let i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},qc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){let s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,l=s>>2,d=(s&3)<<4|a>>4,p=(a&15)<<2|u>>6,_=u&63;c||(_=64,o||(p=64)),r.push(n[l],n[d],n[p],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Uc(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Kd(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){let s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;let u=i<t.length?n[t.charAt(i)]:64;++i;let d=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||d==null)throw new es;let p=s<<2|a>>4;if(r.push(p),u!==64){let _=a<<4&240|u>>2;if(r.push(_),d!==64){let S=u<<6&192|d;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},es=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Hd=function(t){let e=Uc(t);return qc.encodeByteArray(e,!0)},mn=function(t){return Hd(t).replace(/\./g,"")},ns=function(t){try{return qc.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Qd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Jd=()=>Qd().__FIREBASE_DEFAULTS__,Yd=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Xd=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&ns(t[1]);return e&&JSON.parse(e)},_r=()=>{try{return Jd()||Yd()||Xd()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},rs=t=>{var e,n;return(n=(e=_r())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Bc=t=>{let e=rs(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},is=()=>{var t;return(t=_r())===null||t===void 0?void 0:t.config},ss=t=>{var e;return(e=_r())===null||e===void 0?void 0:e[`_${t}`]};var gr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function $c(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[mn(JSON.stringify(n)),mn(JSON.stringify(o)),""].join(".")}function F(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zc(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(F())}function Zd(){var t;let e=(t=_r())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jc(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Gc(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Wc(){let t=F();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Kc(){return!Zd()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function os(){try{return typeof indexedDB=="object"}catch{return!1}}function Hc(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var ef="FirebaseError",ie=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=ef,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pe.prototype.create)}},Pe=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?tf(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ie(i,a,r)}};function tf(t,e){return t.replace(nf,(n,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var nf=/\{\$([^}]+)}/g;function Qc(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function rt(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let i of n){if(!r.includes(i))return!1;let s=t[i],o=e[i];if(Fc(s)&&Fc(o)){if(!rt(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!n.includes(i))return!1;return!0}function Fc(t){return t!==null&&typeof t=="object"}function gn(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Nt(t){let e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ot(t){let e=t.indexOf("?");if(!e)return"";let n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Jc(t,e){let n=new ts(t,e);return n.subscribe.bind(n)}var ts=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");rf(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Zi),i.error===void 0&&(i.error=Zi),i.complete===void 0&&(i.complete=Zi);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function rf(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Zi(){}var AI=4*60*60*1e3;function te(t){return t&&t._delegate?t._delegate:t}var le=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var it="[DEFAULT]";var as=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new gr;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(of(e))try{this.getOrInitializeService({instanceIdentifier:it})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=it){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return h(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=it){return this.instances.has(e)}getOptions(e=it){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;let i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:sf(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=it){return this.component?this.component.multipleInstances?e:it:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function sf(t){return t===it?void 0:t}function of(t){return t.instantiationMode==="EAGER"}var yr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new as(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var af=[],T=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(T||{}),cf={debug:T.DEBUG,verbose:T.VERBOSE,info:T.INFO,warn:T.WARN,error:T.ERROR,silent:T.SILENT},uf=T.INFO,lf={[T.DEBUG]:"log",[T.VERBOSE]:"log",[T.INFO]:"info",[T.WARN]:"warn",[T.ERROR]:"error"},hf=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),i=lf[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},qe=class{constructor(e){this.name=e,this._logLevel=uf,this._logHandler=hf,this._userLogHandler=null,af.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in T))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cf[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,T.DEBUG,...e),this._logHandler(this,T.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,T.VERBOSE,...e),this._logHandler(this,T.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,T.INFO,...e),this._logHandler(this,T.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,T.WARN,...e),this._logHandler(this,T.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,T.ERROR,...e),this._logHandler(this,T.ERROR,...e)}};var df=(t,e)=>e.some(n=>t instanceof n),Yc,Xc;function ff(){return Yc||(Yc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pf(){return Xc||(Xc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Zc=new WeakMap,us=new WeakMap,eu=new WeakMap,cs=new WeakMap,hs=new WeakMap;function mf(t){let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(_e(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Zc.set(n,t)}).catch(()=>{}),hs.set(e,t),e}function gf(t){if(us.has(t))return;let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});us.set(t,e)}var ls={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return us.get(t);if(e==="objectStoreNames")return t.objectStoreNames||eu.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _e(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tu(t){ls=t(ls)}function _f(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call(Ir(this),e,...n);return eu.set(r,e.sort?e.sort():[e]),_e(r)}:pf().includes(t)?function(...e){return t.apply(Ir(this),e),_e(Zc.get(this))}:function(...e){return _e(t.apply(Ir(this),e))}}function yf(t){return typeof t=="function"?_f(t):(t instanceof IDBTransaction&&gf(t),df(t,ff())?new Proxy(t,ls):t)}function _e(t){if(t instanceof IDBRequest)return mf(t);if(cs.has(t))return cs.get(t);let e=yf(t);return e!==t&&(cs.set(t,e),hs.set(e,t)),e}var Ir=t=>hs.get(t);function ru(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(t,e),a=_e(o);return r&&o.addEventListener("upgradeneeded",c=>{r(_e(o.result),c.oldVersion,c.newVersion,_e(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var If=["get","getKey","getAll","getAllKeys","count"],vf=["put","add","delete","clear"],ds=new Map;function nu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ds.get(e))return ds.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,i=vf.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||If.includes(n)))return;let s=function(o,...a){return h(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(yield Promise.all([u[n](...a),i&&c.done]))[0]})};return ds.set(e,s),s}tu(t=>kc(Dc({},t),{get:(e,n,r)=>nu(e,n)||t.get(e,n,r),has:(e,n)=>!!nu(e,n)||t.has(e,n)}));var ps=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Ef(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function Ef(t){let e=t.getComponent();return e?.type==="VERSION"}var ms="@firebase/app",iu="0.10.2";var st=new qe("@firebase/app"),wf="@firebase/app-compat",Tf="@firebase/analytics-compat",Af="@firebase/analytics",Sf="@firebase/app-check-compat",bf="@firebase/app-check",Rf="@firebase/auth",Pf="@firebase/auth-compat",Cf="@firebase/database",Df="@firebase/database-compat",kf="@firebase/functions",Nf="@firebase/functions-compat",Of="@firebase/installations",xf="@firebase/installations-compat",Vf="@firebase/messaging",Lf="@firebase/messaging-compat",Mf="@firebase/performance",Ff="@firebase/performance-compat",Uf="@firebase/remote-config",qf="@firebase/remote-config-compat",Bf="@firebase/storage",$f="@firebase/storage-compat",zf="@firebase/firestore",jf="@firebase/firestore-compat",Gf="firebase",Wf="10.11.1";var gs="[DEFAULT]",Kf={[ms]:"fire-core",[wf]:"fire-core-compat",[Af]:"fire-analytics",[Tf]:"fire-analytics-compat",[bf]:"fire-app-check",[Sf]:"fire-app-check-compat",[Rf]:"fire-auth",[Pf]:"fire-auth-compat",[Cf]:"fire-rtdb",[Df]:"fire-rtdb-compat",[kf]:"fire-fn",[Nf]:"fire-fn-compat",[Of]:"fire-iid",[xf]:"fire-iid-compat",[Vf]:"fire-fcm",[Lf]:"fire-fcm-compat",[Mf]:"fire-perf",[Ff]:"fire-perf-compat",[Uf]:"fire-rc",[qf]:"fire-rc-compat",[Bf]:"fire-gcs",[$f]:"fire-gcs-compat",[zf]:"fire-fst",[jf]:"fire-fst-compat","fire-js":"fire-js",[Gf]:"fire-js-all"};var _n=new Map,Hf=new Map,_s=new Map;function su(t,e){try{t.container.addComponent(e)}catch(n){st.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $e(t){let e=t.name;if(_s.has(e))return st.debug(`There were multiple attempts to register component ${e}.`),!1;_s.set(e,t);for(let n of _n.values())su(n,t);for(let n of Hf.values())su(n,t);return!0}function In(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function fe(t){return t.settings!==void 0}var Qf={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Be=new Pe("app","Firebase",Qf);var ys=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new le("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Be.create("app-deleted",{appName:this._name})}};var ze=Wf;function Es(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=Object.assign({name:gs,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Be.create("bad-app-name",{appName:String(i)});if(n||(n=is()),!n)throw Be.create("no-options");let s=_n.get(i);if(s){if(rt(n,s.options)&&rt(r,s.config))return s;throw Be.create("duplicate-app",{appName:i})}let o=new yr(i);for(let c of _s.values())o.addComponent(c);let a=new ys(n,r,o);return _n.set(i,a),a}function xt(t=gs){let e=_n.get(t);if(!e&&t===gs&&is())return Es();if(!e)throw Be.create("no-app",{appName:t});return e}function vr(){return Array.from(_n.values())}function U(t,e,n){var r;let i=(r=Kf[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),st.warn(a.join(" "));return}$e(new le(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Jf="firebase-heartbeat-database",Yf=1,yn="firebase-heartbeat-store",fs=null;function uu(){return fs||(fs=ru(Jf,Yf,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(yn)}catch(n){console.warn(n)}}}}).catch(t=>{throw Be.create("idb-open",{originalErrorMessage:t.message})})),fs}function Xf(t){return h(this,null,function*(){try{let n=(yield uu()).transaction(yn),r=yield n.objectStore(yn).get(lu(t));return yield n.done,r}catch(e){if(e instanceof ie)st.warn(e.message);else{let n=Be.create("idb-get",{originalErrorMessage:e?.message});st.warn(n.message)}}})}function ou(t,e){return h(this,null,function*(){try{let r=(yield uu()).transaction(yn,"readwrite");yield r.objectStore(yn).put(e,lu(t)),yield r.done}catch(n){if(n instanceof ie)st.warn(n.message);else{let r=Be.create("idb-set",{originalErrorMessage:n?.message});st.warn(r.message)}}})}function lu(t){return`${t.name}!${t.options.appId}`}var Zf=1024,ep=30*24*60*60*1e3,Is=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new vs(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return h(this,null,function*(){var e,n;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=au();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=ep}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return h(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=au(),{heartbeatsToSend:r,unsentEntries:i}=tp(this._heartbeatsCache.heartbeats),s=mn(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function au(){return new Date().toISOString().substring(0,10)}function tp(t,e=Zf){let n=[],r=t.slice();for(let i of t){let s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),cu(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),cu(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var vs=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return h(this,null,function*(){return os()?Hc().then(()=>!0).catch(()=>!1):!1})}read(){return h(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield Xf(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return h(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return ou(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return h(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return ou(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function cu(t){return mn(JSON.stringify({version:2,heartbeats:t})).length}function np(t){$e(new le("platform-logger",e=>new ps(e),"PRIVATE")),$e(new le("heartbeat",e=>new Is(e),"PRIVATE")),U(ms,iu,t),U(ms,iu,"esm2017"),U("fire-js","")}np("");var rp="firebase",ip="10.11.1";U(rp,ip,"app");var at=new Lc("ANGULARFIRE2_VERSION");function Tr(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var vn=(t,e)=>{let n=e?[e]:vr(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Lt=class{constructor(){return vn(sp)}},sp="app-check";function Vt(){}var Er=class{zone;delegate;constructor(e,n=Oc){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},ws=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Vt,{},Vt,Vt)),n.pipe(xc({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Mt=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Er(Zone.current)),this.insideAngular=n.run(()=>new Er(Zone.current,Nc)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(Ct(Ue))};static \u0275prov=mr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ar(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function op(t){return Ar().ngZone.runOutsideAngular(()=>t())}function ot(t){return Ar().ngZone.run(()=>t())}function ap(t){return cp(Ar())(t)}function cp(t){return function(n){return n=n.lift(new ws(t.ngZone)),n.pipe(Xi(t.outsideAngular),Yi(t.insideAngular))}}var up=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),ot(()=>t.apply(void 0,r))},he=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=ot(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Vt,{},Vt,Vt))),r[s]=up(r[s],n));let i=op(()=>t.apply(this,r));if(!e)if(i instanceof pn){let s=Ar();return i.pipe(Xi(s.outsideAngular),Yi(s.insideAngular))}else return ot(()=>i);return i instanceof pn?i.pipe(ap):i instanceof Promise?ot(()=>new Promise((s,o)=>i.then(a=>ot(()=>s(a)),a=>ot(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:ot(()=>i)};var Ce=class{constructor(e){return e}},ct=class{constructor(){return vr()}};function lp(t){return t&&t.length===1?t[0]:new Ce(xt())}var Ts=new Pt("angularfire2._apps"),hp={provide:Ce,useFactory:lp,deps:[[new ue,Ts]]},dp={provide:ct,deps:[[new ue,Ts]]};function fp(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Ce(r)}}var pp=(()=>{class t{constructor(n){U("angularfire",at.full,"core"),U("angularfire",at.full,"app"),U("angular",Mc.full,n.toString())}static \u0275fac=function(r){return new(r||t)(Ct(Vc))};static \u0275mod=Dt({type:t});static \u0275inj=Rt({providers:[hp,dp]})}return t})();function cv(t,...e){return{ngModule:pp,providers:[{provide:Ts,useFactory:fp(t),multi:!0,deps:[Ue,kt,Mt,...e]}]}}var uv=he(Es,!0);function Ru(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Pu=Ru,Cu=new Pe("auth","Firebase",Ru());var Dr=new qe("@firebase/auth");function mp(t,...e){Dr.logLevel<=T.WARN&&Dr.warn(`Auth (${ze}): ${t}`,...e)}function br(t,...e){Dr.logLevel<=T.ERROR&&Dr.error(`Auth (${ze}): ${t}`,...e)}function Ie(t,...e){throw Ws(t,...e)}function ut(t,...e){return Ws(t,...e)}function Du(t,e,n){let r=Object.assign(Object.assign({},Pu()),{[e]:n});return new Pe("auth","Firebase",r).create(e,{appName:t.name})}function Ne(t){return Du(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ws(t,...e){if(typeof t!="string"){let n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Cu.create(t,...e)}function v(t,e,...n){if(!t)throw Ws(e,...n)}function De(t){let e="INTERNAL ASSERTION FAILED: "+t;throw br(e),new Error(e)}function Ge(t,e){t||De(e)}function Rs(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function gp(){return hu()==="http:"||hu()==="https:"}function hu(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function _p(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(gp()||jc()||"connection"in navigator)?navigator.onLine:!0}function yp(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var lt=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ge(n>e,"Short delay should be less than long delay!"),this.isMobile=zc()||Gc()}get(){return _p()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ks(t,e){Ge(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var kr=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;De("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;De("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;De("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Ip={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var vp=new lt(3e4,6e4);function We(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Ke(s,o,a,c){return h(this,arguments,function*(t,e,n,r,i={}){return ku(t,i,()=>h(this,null,function*(){let u={},l={};r&&(e==="GET"?l=r:u={body:JSON.stringify(r)});let d=gn(Object.assign({key:t.config.apiKey},l)).slice(1),p=yield t._getAdditionalHeaders();return p["Content-Type"]="application/json",t.languageCode&&(p["X-Firebase-Locale"]=t.languageCode),kr.fetch()(Nu(t,t.config.apiHost,n,d),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},u))}))})}function ku(t,e,n){return h(this,null,function*(){t._canInitEmulator=!1;let r=Object.assign(Object.assign({},Ip),e);try{let i=new Ps(t),s=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Sr(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sr(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Sr(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Sr(t,"user-disabled",o);let l=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Du(t,l,u);Ie(t,l)}}catch(i){if(i instanceof ie)throw i;Ie(t,"network-request-failed",{message:String(i)})}})}function Pn(s,o,a,c){return h(this,arguments,function*(t,e,n,r,i={}){let u=yield Ke(t,e,n,r,i);return"mfaPendingCredential"in u&&Ie(t,"multi-factor-auth-required",{_serverResponse:u}),u})}function Nu(t,e,n,r){let i=`${e}${n}?${r}`;return t.config.emulator?Ks(t.config,i):`${t.config.apiScheme}://${i}`}function Ep(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Ps=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ut(this.auth,"network-request-failed")),vp.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Sr(t,e,n){let r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=ut(t,e,r);return i.customData._tokenResponse=n,i}function du(t){return t!==void 0&&t.enterprise!==void 0}var Cs=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Ep(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function wp(t,e){return h(this,null,function*(){return Ke(t,"GET","/v2/recaptchaConfig",We(t,e))})}function Tp(t,e){return h(this,null,function*(){return Ke(t,"POST","/v1/accounts:delete",e)})}function Ou(t,e){return h(this,null,function*(){return Ke(t,"POST","/v1/accounts:lookup",e)})}function En(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Hs(t,e=!1){return h(this,null,function*(){let n=te(t),r=yield n.getIdToken(e),i=Qs(r);v(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:En(As(i.auth_time)),issuedAtTime:En(As(i.iat)),expirationTime:En(As(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function As(t){return Number(t)*1e3}function Qs(t){let[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return br("JWT malformed, contained fewer than 3 sections"),null;try{let i=ns(n);return i?JSON.parse(i):(br("Failed to decode base64 JWT payload"),null)}catch(i){return br("Caught error parsing JWT payload as JSON",i?.toString()),null}}function fu(t){let e=Qs(t);return v(e,"internal-error"),v(typeof e.exp<"u","internal-error"),v(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Tn(t,e,n=!1){return h(this,null,function*(){if(n)return e;try{return yield e}catch(r){throw r instanceof ie&&Ap(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})}function Ap({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var Ds=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>h(this,null,function*(){yield this.iteration()}),n)}iteration(){return h(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var An=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=En(this.lastLoginAt),this.creationTime=En(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Nr(t){return h(this,null,function*(){var e;let n=t.auth,r=yield t.getIdToken(),i=yield Tn(t,Ou(n,{idToken:r}));v(i?.users.length,n,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?xu(s.providerUserInfo):[],a=Sp(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!a?.length,l=c?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new An(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,d)})}function Js(t){return h(this,null,function*(){let e=te(t);yield Nr(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Sp(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function xu(t){return t.map(e=>{var{providerId:n}=e,r=Ji(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function bp(t,e){return h(this,null,function*(){let n=yield ku(t,{},()=>h(this,null,function*(){let r=gn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=Nu(t,i,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",kr.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function Rp(t,e){return h(this,null,function*(){return Ke(t,"POST","/v2/accounts:revokeToken",We(t,e))})}var wn=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){v(e.idToken,"internal-error"),v(typeof e.idToken<"u","internal-error"),v(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fu(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){v(e.length!==0,"internal-error");let n=fu(e);this.updateTokensAndExpiration(e,null,n)}getToken(e,n=!1){return h(this,null,function*(){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(v(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return h(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield bp(e,n);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){let{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new t;return r&&(v(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(v(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(v(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return De("not implemented")}};function je(t,e){v(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var Ft=class t{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Ji(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ds(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new An(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return h(this,null,function*(){let n=yield Tn(this,this.stsTokenManager.getToken(this.auth,e));return v(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return Hs(this,e)}reload(){return Js(this)}_assign(e){this!==e&&(v(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){v(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return h(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&(yield Nr(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return h(this,null,function*(){if(fe(this.auth.app))return Promise.reject(Ne(this.auth));let e=yield this.getIdToken();return yield Tn(this,Tp(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,c,u,l;let d=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(i=n.email)!==null&&i!==void 0?i:void 0,_=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(a=n.tenantId)!==null&&a!==void 0?a:void 0,R=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,B=(u=n.createdAt)!==null&&u!==void 0?u:void 0,ee=(l=n.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:ce,emailVerified:ge,isAnonymous:hn,providerData:nt,stsTokenManager:dn}=n;v(ce&&dn,e,"internal-error");let Cc=wn.fromJSON(this.name,dn);v(typeof ce=="string",e,"internal-error"),je(d,e.name),je(p,e.name),v(typeof ge=="boolean",e,"internal-error"),v(typeof hn=="boolean",e,"internal-error"),je(_,e.name),je(S,e.name),je(C,e.name),je(R,e.name),je(B,e.name),je(ee,e.name);let fn=new t({uid:ce,auth:e,email:p,emailVerified:ge,displayName:d,isAnonymous:hn,photoURL:S,phoneNumber:_,tenantId:C,stsTokenManager:Cc,createdAt:B,lastLoginAt:ee});return nt&&Array.isArray(nt)&&(fn.providerData=nt.map(pr=>Object.assign({},pr))),R&&(fn._redirectEventId=R),fn}static _fromIdTokenResponse(e,n,r=!1){return h(this,null,function*(){let i=new wn;i.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Nr(s),s})}static _fromGetAccountInfoResponse(e,n,r){return h(this,null,function*(){let i=n.users[0];v(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?xu(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new wn;a.updateFromIdToken(r);let c=new t({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new An(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,u),c})}};var pu=new Map;function ke(t){Ge(t instanceof Function,"Expected a class definition");let e=pu.get(t);return e?(Ge(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,pu.set(t,e),e)}var Pp=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return h(this,null,function*(){return!0})}_set(n,r){return h(this,null,function*(){this.storage[n]=r})}_get(n){return h(this,null,function*(){let r=this.storage[n];return r===void 0?null:r})}_remove(n){return h(this,null,function*(){delete this.storage[n]})}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})(),ks=Pp;function Rr(t,e,n){return`firebase:${t}:${e}:${n}`}var Or=class t{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Rr(this.userKey,i.apiKey,s),this.fullPersistenceKey=Rr("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return h(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Ft._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return h(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return h(this,null,function*(){if(!n.length)return new t(ke(ks),e,r);let i=(yield Promise.all(n.map(u=>h(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||ke(ks),o=Rr(r,e.config.apiKey,e.name),a=null;for(let u of n)try{let l=yield u._get(o);if(l){let d=Ft._fromJSON(e,l);u!==s&&(a=d),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(u=>h(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new t(s,e,r))})}};function mu(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Mu(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Vu(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Uu(e))return"Blackberry";if(qu(e))return"Webos";if(Ys(e))return"Safari";if((e.includes("chrome/")||Lu(e))&&!e.includes("edge/"))return"Chrome";if(Fu(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function Vu(t=F()){return/firefox\//i.test(t)}function Ys(t=F()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Lu(t=F()){return/crios\//i.test(t)}function Mu(t=F()){return/iemobile/i.test(t)}function Fu(t=F()){return/android/i.test(t)}function Uu(t=F()){return/blackberry/i.test(t)}function qu(t=F()){return/webos/i.test(t)}function Br(t=F()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Cp(t=F()){var e;return Br(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Dp(){return Wc()&&document.documentMode===10}function Bu(t=F()){return Br(t)||Fu(t)||qu(t)||Uu(t)||/windows phone/i.test(t)||Mu(t)}function kp(){try{return!!(window&&window!==window.top)}catch{return!1}}function $u(t,e=[]){let n;switch(t){case"Browser":n=mu(F());break;case"Worker":n=`${mu(F())}-${t}`;break;default:n=t}let r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ze}/${r}`}var Ns=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return h(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let r of this.queue)yield r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(let i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Np(n){return h(this,arguments,function*(t,e={}){return Ke(t,"GET","/v2/passwordPolicy",We(t,e))})}var Op=6,Os=class{constructor(e){var n,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Op,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var xs=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xr(this),this.idTokenSubscription=new xr(this),this.beforeStateQueue=new Ns(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Cu,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ke(n)),this._initializationPromise=this.queue(()=>h(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Or.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return h(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return h(this,null,function*(){try{let n=yield Ou(this,{idToken:e}),r=yield Ft._fromGetAccountInfoResponse(this,n,e);yield this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return h(this,null,function*(){var n;if(fe(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return v(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return h(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return h(this,null,function*(){try{yield Nr(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=yp()}_delete(){return h(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return h(this,null,function*(){if(fe(this.app))return Promise.reject(Ne(this));let n=e?te(e):null;return n&&v(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return h(this,null,function*(){if(!this._deleted)return e&&v(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>h(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return h(this,null,function*(){return fe(this.app)?Promise.reject(Ne(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return fe(this.app)?Promise.reject(Ne(this)):this.queue(()=>h(this,null,function*(){yield this.assertedPersistence.setPersistence(ke(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return h(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return h(this,null,function*(){let e=yield Np(this),n=new Os(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pe("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){return h(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Rp(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return h(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return h(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&ke(e)||this._popupRedirectResolver;v(n,this,"argument-error"),this.redirectPersistenceManager=yield Or.create(this,[ke(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return h(this,null,function*(){var n,r;return this._isInitialized&&(yield this.queue(()=>h(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return h(this,null,function*(){if(e===this.currentUser)return this.queue(()=>h(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(v(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(n);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return h(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return v(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$u(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return h(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(n["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n})}_getAppCheckToken(){return h(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&mp(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function dt(t){return te(t)}var xr=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Jc(n=>this.observer=n)}get next(){return v(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var $r={loadJS(){return h(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xp(t){$r=t}function zu(t){return $r.loadJS(t)}function Vp(){return $r.recaptchaEnterpriseScript}function Lp(){return $r.gapiScript}function ju(t){return`__${t}${Math.floor(Math.random()*1e6)}`}var Mp="recaptcha-enterprise",Fp="NO_RECAPTCHA",Vs=class{constructor(e){this.type=Mp,this.auth=dt(e)}verify(e="verify",n=!1){return h(this,null,function*(){function r(s){return h(this,null,function*(){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>h(this,null,function*(){wp(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let u=new Cs(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;du(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(Fp)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&du(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Vp();c.length!==0&&(c+=a),zu(c).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})})}};function gu(t,e,n,r=!1){return h(this,null,function*(){let i=new Vs(t),s;try{s=yield i.verify(n)}catch{s=yield i.verify(n,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Ls(t,e,n,r){return h(this,null,function*(){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield gu(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(s=>h(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield gu(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)}))})}function Xs(t,e){let n=In(t,"auth");if(n.isInitialized()){let i=n.getImmediate(),s=n.getOptions();if(rt(s,e??{}))return i;Ie(i,"already-initialized")}return n.initialize({options:e})}function Up(t,e){let n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(ke);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function Zs(t,e,n){let r=dt(t);v(r._canInitEmulator,r,"emulator-config-failed"),v(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!n?.disableWarnings,s=Gu(e),{host:o,port:a}=qp(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Bp()}function Gu(t){let e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qp(t){let e=Gu(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};let r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:_u(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:_u(o)}}}function _u(t){if(!t)return null;let e=Number(t);return isNaN(e)?null:e}function Bp(){function t(){let e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}var Sn=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return De("not implemented")}_getIdTokenResponse(e){return De("not implemented")}_linkToIdToken(e,n){return De("not implemented")}_getReauthenticationResolver(e){return De("not implemented")}};function $p(t,e){return h(this,null,function*(){return Ke(t,"POST","/v1/accounts:signUp",e)})}function zp(t,e){return h(this,null,function*(){return Pn(t,"POST","/v1/accounts:signInWithPassword",We(t,e))})}function jp(t,e){return h(this,null,function*(){return Pn(t,"POST","/v1/accounts:signInWithEmailLink",We(t,e))})}function Gp(t,e){return h(this,null,function*(){return Pn(t,"POST","/v1/accounts:signInWithEmailLink",We(t,e))})}var bn=class t extends Sn{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new t(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new t(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}_getIdTokenResponse(e){return h(this,null,function*(){switch(this.signInMethod){case"password":let n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ls(e,n,"signInWithPassword",zp);case"emailLink":return jp(e,{email:this._email,oobCode:this._password});default:Ie(e,"internal-error")}})}_linkToIdToken(e,n){return h(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ls(e,r,"signUpPassword",$p);case"emailLink":return Gp(e,{idToken:n,email:this._email,oobCode:this._password});default:Ie(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ss(t,e){return h(this,null,function*(){return Pn(t,"POST","/v1/accounts:signInWithIdp",We(t,e))})}function Wp(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Kp(t){let e=Nt(Ot(t)).link,n=e?Nt(Ot(e)).deep_link_id:null,r=Nt(Ot(t)).deep_link_id;return(r?Nt(Ot(r)).link:null)||r||n||e||t}var Vr=class t{constructor(e){var n,r,i,s,o,a;let c=Nt(Ot(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,l=(r=c.oobCode)!==null&&r!==void 0?r:null,d=Wp((i=c.mode)!==null&&i!==void 0?i:null);v(u&&l&&d,"argument-error"),this.apiKey=u,this.operation=d,this.code=l,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let n=Kp(e);try{return new t(n)}catch{return null}}};var Wu=(()=>{class t{constructor(){this.providerId=t.PROVIDER_ID}static credential(n,r){return bn._fromEmailAndPassword(n,r)}static credentialWithLink(n,r){let i=Vr.parseLink(r);return v(i,"argument-error"),bn._fromEmailAndCode(n,i.code,i.tenantId)}}t.PROVIDER_ID="password",t.EMAIL_PASSWORD_SIGN_IN_METHOD="password",t.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return t})(),Lr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Ms=class extends Lr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function Hp(t,e){return h(this,null,function*(){return Pn(t,"POST","/v1/accounts:signUp",We(t,e))})}var Ut=class t{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,n,r,i=!1){return h(this,null,function*(){let s=yield Ft._fromIdTokenResponse(e,r,i),o=yu(r);return new t({user:s,providerId:o,_tokenResponse:r,operationType:n})})}static _forOperation(e,n,r){return h(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=yu(r);return new t({user:e,providerId:i,_tokenResponse:r,operationType:n})})}};function yu(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}var Fs=class t extends ie{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,t.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new t(e,n,r,i)}};function Ku(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Fs._fromErrorAndOperation(t,s,e,r):s})}function Qp(t,e,n=!1){return h(this,null,function*(){let r=yield Tn(t,e._linkToIdToken(t.auth,yield t.getIdToken()),n);return Ut._forOperation(t,"link",r)})}function Jp(t,e,n=!1){return h(this,null,function*(){let{auth:r}=t;if(fe(r.app))return Promise.reject(Ne(r));let i="reauthenticate";try{let s=yield Tn(t,Ku(r,i,e,t),n);v(s.idToken,r,"internal-error");let o=Qs(s.idToken);v(o,r,"internal-error");let{sub:a}=o;return v(t.uid===a,r,"user-mismatch"),Ut._forOperation(t,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ie(r,"user-mismatch"),s}})}function Hu(t,e,n=!1){return h(this,null,function*(){if(fe(t.app))return Promise.reject(Ne(t));let r="signIn",i=yield Ku(t,r,e),s=yield Ut._fromIdTokenResponse(t,r,i);return n||(yield t._updateCurrentUser(s.user)),s})}function eo(t,e){return h(this,null,function*(){return Hu(dt(t),e)})}function Qu(t){return h(this,null,function*(){let e=dt(t);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function to(t,e,n){return h(this,null,function*(){if(fe(t.app))return Promise.reject(Ne(t));let r=dt(t),o=yield Ls(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Hp).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Qu(t),c}),a=yield Ut._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function no(t,e,n){return fe(t.app)?Promise.reject(Ne(t)):eo(te(t),Wu.credential(e,n)).catch(r=>h(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Qu(t),r}))}function Cn(t,e,n,r){return te(t).onIdTokenChanged(e,n,r)}function ro(t,e,n){return te(t).beforeAuthStateChanged(e,n)}function io(t){return te(t).signOut()}var Mr="__sak";var Fr=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Mr,"1"),this.storage.removeItem(Mr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){let n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function Yp(){let t=F();return Ys(t)||Br(t)}var Xp=1e3,Zp=10,em=(()=>{class t extends Fr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,r)=>this.onStorageEvent(n,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Yp()&&kp(),this.fallbackToPolling=Bu(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&n(r,s,i)}}onStorageEvent(n,r=!1){if(!n.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=n.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(n.newValue!==a)n.newValue!==null?this.storage.setItem(i,n.newValue):this.storage.removeItem(i);else if(this.localCache[i]===n.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);Dp()&&o!==n.newValue&&n.newValue!==n.oldValue?setTimeout(s,Zp):s()}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:r,newValue:i}),!0)})},Xp)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(n,r){return h(this,null,function*(){yield Fe(t.prototype,this,"_set").call(this,n,r),this.localCache[n]=JSON.stringify(r)})}_get(n){return h(this,null,function*(){let r=yield Fe(t.prototype,this,"_get").call(this,n);return this.localCache[n]=JSON.stringify(r),r})}_remove(n){return h(this,null,function*(){yield Fe(t.prototype,this,"_remove").call(this,n),delete this.localCache[n]})}}return t.type="LOCAL",t})(),Ju=em;var tm=(()=>{class t extends Fr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,r){}_removeListener(n,r){}}return t.type="SESSION",t})(),so=tm;function nm(t){return Promise.all(t.map(e=>h(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(n){return{fulfilled:!1,reason:n}}})))}var rm=(()=>{class t{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){let r=this.receivers.find(s=>s.isListeningto(n));if(r)return r;let i=new t(n);return this.receivers.push(i),i}isListeningto(n){return this.eventTarget===n}handleEvent(n){return h(this,null,function*(){let r=n,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(l=>h(this,null,function*(){return l(r.origin,o)})),u=yield nm(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:u})})}_subscribe(n,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(r)}_unsubscribe(n,r){this.handlersMap[n]&&r&&this.handlersMap[n].delete(r),(!r||this.handlersMap[n].size===0)&&delete this.handlersMap[n],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}t.receivers=[];return t})();function Yu(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}var Us=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,n,r=50){return h(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let u=Yu("",20);i.port1.start();let l=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(d){let p=d;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(l),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(l),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function ye(){return window}function im(t){ye().location.href=t}function Xu(){return typeof ye().WorkerGlobalScope<"u"&&typeof ye().importScripts=="function"}function sm(){return h(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function om(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function am(){return Xu()?self:null}var Zu="firebaseLocalStorageDb",cm=1,Ur="firebaseLocalStorage",el="fbase_key",ht=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function zr(t,e){return t.transaction([Ur],e?"readwrite":"readonly").objectStore(Ur)}function um(){let t=indexedDB.deleteDatabase(Zu);return new ht(t).toPromise()}function qs(){let t=indexedDB.open(Zu,cm);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{let r=t.result;try{r.createObjectStore(Ur,{keyPath:el})}catch(i){n(i)}}),t.addEventListener("success",()=>h(this,null,function*(){let r=t.result;r.objectStoreNames.contains(Ur)?e(r):(r.close(),yield um(),e(yield qs()))}))})}function Iu(t,e,n){return h(this,null,function*(){let r=zr(t,!0).put({[el]:e,value:n});return new ht(r).toPromise()})}function lm(t,e){return h(this,null,function*(){let n=zr(t,!1).get(e),r=yield new ht(n).toPromise();return r===void 0?null:r.value})}function vu(t,e){let n=zr(t,!0).delete(e);return new ht(n).toPromise()}var hm=800,dm=3,fm=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return h(this,null,function*(){return this.db?this.db:(this.db=yield qs(),this.db)})}_withRetries(n){return h(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield n(i)}catch(i){if(r++>dm)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return h(this,null,function*(){return Xu()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return h(this,null,function*(){this.receiver=rm._getInstance(am()),this.receiver._subscribe("keyChanged",(n,r)=>h(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(n,r)=>h(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return h(this,null,function*(){var n,r;if(this.activeServiceWorker=yield sm(),!this.activeServiceWorker)return;this.sender=new Us(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((n=i[0])===null||n===void 0)&&n.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(n){return h(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||om()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:n},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return h(this,null,function*(){try{if(!indexedDB)return!1;let n=yield qs();return yield Iu(n,Mr,"1"),yield vu(n,Mr),!0}catch{}return!1})}_withPendingWrite(n){return h(this,null,function*(){this.pendingWrites++;try{yield n()}finally{this.pendingWrites--}})}_set(n,r){return h(this,null,function*(){return this._withPendingWrite(()=>h(this,null,function*(){return yield this._withRetries(i=>Iu(i,n,r)),this.localCache[n]=r,this.notifyServiceWorker(n)}))})}_get(n){return h(this,null,function*(){let r=yield this._withRetries(i=>lm(i,n));return this.localCache[n]=r,r})}_remove(n){return h(this,null,function*(){return this._withPendingWrite(()=>h(this,null,function*(){return yield this._withRetries(r=>vu(r,n)),delete this.localCache[n],this.notifyServiceWorker(n)}))})}_poll(){return h(this,null,function*(){let n=yield this._withRetries(s=>{let o=zr(s,!1).getAll();return new ht(o).toPromise()});if(!n)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(n.length!==0)for(let{fbase_key:s,value:o}of n)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>h(this,null,function*(){return this._poll()}),hm)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return t.type="LOCAL",t})(),tl=fm;var _v=ju("rcb"),yv=new lt(3e4,6e4);function pm(t,e){return e?ke(e):(v(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var Rn=class extends Sn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ss(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ss(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ss(e,this._buildIdpRequest())}_buildIdpRequest(e){let n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function mm(t){return Hu(t.auth,new Rn(t),t.bypassAuthState)}function gm(t){let{auth:e,user:n}=t;return v(n,e,"internal-error"),Jp(n,new Rn(t),t.bypassAuthState)}function _m(t){return h(this,null,function*(){let{auth:e,user:n}=t;return v(n,e,"internal-error"),Qp(n,new Rn(t),t.bypassAuthState)})}var Bs=class{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise((e,n)=>h(this,null,function*(){this.pendingPromise={resolve:e,reject:n};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return h(this,null,function*(){let{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mm;case"linkViaPopup":case"linkViaRedirect":return _m;case"reauthViaPopup":case"reauthViaRedirect":return gm;default:Ie(this.auth,"internal-error")}}resolve(e){Ge(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ge(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Iv=new lt(2e3,1e4);var ym="pendingRedirect",Pr=new Map,$s=class t extends Bs{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}execute(){return h(this,null,function*(){let e=Pr.get(this.auth._key());if(!e){try{let r=(yield Im(this.resolver,this.auth))?yield Fe(t.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Pr.set(this.auth._key(),e)}return this.bypassAuthState||Pr.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return h(this,null,function*(){if(e.type==="signInViaRedirect")return Fe(t.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let n=yield this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,Fe(t.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return h(this,null,function*(){})}cleanUp(){}};function Im(t,e){return h(this,null,function*(){let n=wm(e),r=Em(t);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(n))==="true";return yield r._remove(n),i})}function vm(t,e){Pr.set(t._key(),e)}function Em(t){return ke(t._redirectPersistence)}function wm(t){return Rr(ym,t.config.apiKey,t.name)}function Tm(t,e,n=!1){return h(this,null,function*(){if(fe(t.app))return Promise.reject(Ne(t));let r=dt(t),i=pm(r,e),o=yield new $s(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var Am=10*60*1e3,zs=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Sm(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!nl(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(ut(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){let r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Am&&this.cachedEventUids.clear(),this.cachedEventUids.has(Eu(e))}saveEventToCache(e){this.cachedEventUids.add(Eu(e)),this.lastProcessedEventTime=Date.now()}};function Eu(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function nl({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function Sm(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nl(t);default:return!1}}function bm(n){return h(this,arguments,function*(t,e={}){return Ke(t,"GET","/v1/projects",e)})}var Rm=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Pm=/^https?/;function Cm(t){return h(this,null,function*(){if(t.config.emulator)return;let{authorizedDomains:e}=yield bm(t);for(let n of e)try{if(Dm(n))return}catch{}Ie(t,"unauthorized-domain")})}function Dm(t){let e=Rs(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){let o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Pm.test(n))return!1;if(Rm.test(t))return r===t;let i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var km=new lt(3e4,6e4);function wu(){let t=ye().___jsl;if(t?.H){for(let e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Nm(t){return new Promise((e,n)=>{var r,i,s;function o(){wu(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wu(),n(ut(t,"network-request-failed"))},timeout:km.get()})}if(!((i=(r=ye().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ye().gapi)===null||s===void 0)&&s.load)o();else{let a=ju("iframefcb");return ye()[a]=()=>{gapi.load?o():n(ut(t,"network-request-failed"))},zu(`${Lp()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Cr=null,e})}var Cr=null;function Om(t){return Cr=Cr||Nm(t),Cr}var xm=new lt(5e3,15e3),Vm="__/auth/iframe",Lm="emulator/auth/iframe",Mm={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Fm=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Um(t){let e=t.config;v(e.authDomain,t,"auth-domain-config-required");let n=e.emulator?Ks(e,Lm):`https://${t.config.authDomain}/${Vm}`,r={apiKey:e.apiKey,appName:t.name,v:ze},i=Fm.get(t.config.apiHost);i&&(r.eid=i);let s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${gn(r).slice(1)}`}function qm(t){return h(this,null,function*(){let e=yield Om(t),n=ye().gapi;return v(n,t,"internal-error"),e.open({where:document.body,url:Um(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Mm,dontclear:!0},r=>new Promise((i,s)=>h(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=ut(t,"network-request-failed"),a=ye().setTimeout(()=>{s(o)},xm.get());function c(){ye().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var Bm={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$m=500,zm=600,jm="_blank",Gm="http://localhost",qr=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Wm(t,e,n,r=$m,i=zm){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},Bm),{width:r.toString(),height:i.toString(),top:s,left:o}),u=F().toLowerCase();n&&(a=Lu(u)?jm:n),Vu(u)&&(e=e||Gm,c.scrollbars="yes");let l=Object.entries(c).reduce((p,[_,S])=>`${p}${_}=${S},`,"");if(Cp(u)&&a!=="_self")return Km(e||"",a),new qr(null);let d=window.open(e||"",a,l);v(d,t,"popup-blocked");try{d.focus()}catch{}return new qr(d)}function Km(t,e){let n=document.createElement("a");n.href=t,n.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var Hm="__/auth/handler",Qm="emulator/auth/handler",Jm=encodeURIComponent("fac");function Tu(t,e,n,r,i,s){return h(this,null,function*(){v(t.config.authDomain,t,"auth-domain-config-required"),v(t.config.apiKey,t,"invalid-api-key");let o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ze,eventId:i};if(e instanceof Lr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Qc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[l,d]of Object.entries(s||{}))o[l]=d}if(e instanceof Ms){let l=e.getScopes().filter(d=>d!=="");l.length>0&&(o.scopes=l.join(","))}t.tenantId&&(o.tid=t.tenantId);let a=o;for(let l of Object.keys(a))a[l]===void 0&&delete a[l];let c=yield t._getAppCheckToken(),u=c?`#${Jm}=${encodeURIComponent(c)}`:"";return`${Ym(t)}?${gn(a).slice(1)}${u}`})}function Ym({config:t}){return t.emulator?Ks(t,Qm):`https://${t.authDomain}/${Hm}`}var bs="webStorageSupport",js=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=so,this._completeRedirectFn=Tm,this._overrideRedirectResult=vm}_openPopup(e,n,r,i){return h(this,null,function*(){var s;Ge((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield Tu(e,n,r,Rs(),i);return Wm(e,o,Yu())})}_openRedirect(e,n,r,i){return h(this,null,function*(){yield this._originValidation(e);let s=yield Tu(e,n,r,Rs(),i);return im(s),new Promise(()=>{})})}_initialize(e){let n=e._key();if(this.eventManagers[n]){let{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Ge(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}initAndGetManager(e){return h(this,null,function*(){let n=yield qm(e),r=new zs(e);return n.register("authEvent",i=>(v(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r})}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bs,{type:bs},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[bs];o!==void 0&&n(!!o),Ie(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Cm(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Bu()||Ys()||Br()}},rl=js;var Au="@firebase/auth",Su="1.7.2";var Gs=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return h(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){v(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Xm(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Zm(t){$e(new le("auth",(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;v(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$u(t)},u=new xs(r,i,s,c);return Up(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),$e(new le("auth-internal",e=>{let n=dt(e.getProvider("auth").getImmediate());return(r=>new Gs(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),U(Au,Su,Xm(t)),U(Au,Su,"esm2017")}var eg=5*60,tg=ss("authIdTokenMaxAge")||eg,bu=null,ng=t=>e=>h(void 0,null,function*(){let n=e&&(yield e.getIdTokenResult()),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>tg)return;let i=n?.token;bu!==i&&(bu=i,yield fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function oo(t=xt()){let e=In(t,"auth");if(e.isInitialized())return e.getImmediate();let n=Xs(t,{popupRedirectResolver:rl,persistence:[tl,Ju,so]}),r=ss("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=ng(s.toString());ro(n,o,()=>o(n.currentUser)),Cn(n,a=>o(a))}}let i=rs("auth");return i&&Zs(n,`http://${i}`),n}function rg(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}xp({loadJS(t){return new Promise((e,n)=>{let r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{let s=ut("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",rg().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Zm("Browser");function ol(t){return new pn(function(e){var n=Cn(t,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:n}})}var al="auth",ft=class{constructor(e){return e}},Dn=class{constructor(){return vn(al)}};var ao=new Pt("angularfire2.auth-instances");function Gg(t,e){let n=Tr(al,t,e);return n&&new ft(n)}function Wg(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new ft(r)}}var Kg={provide:Dn,deps:[[new ue,ao]]},Hg={provide:ft,useFactory:Gg,deps:[[new ue,ao],Ce]},Qg=(()=>{class t{constructor(){U("angularfire",at.full,"auth")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Dt({type:t});static \u0275inj=Rt({providers:[Hg,Kg]})}return t})();function lE(t,...e){return{ngModule:Qg,providers:[{provide:ao,useFactory:Wg(t),multi:!0,deps:[Ue,kt,Mt,ct,[new ue,Lt],...e]}]}}var hE=he(ol,!0);var cl=he(to,!0);var dE=he(oo,!0);var ul=he(no,!0);var ll=he(io,!0);var Yg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},me={},g,Do=Do||{},E=Yg||self;function ri(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function jn(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Xg(t){return Object.prototype.hasOwnProperty.call(t,co)&&t[co]||(t[co]=++Zg)}var co="closure_uid_"+(1e9*Math.random()>>>0),Zg=0;function e_(t,e,n){return t.call.apply(t.bind,arguments)}function t_(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Q(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Q=e_:Q=t_,Q.apply(null,arguments)}function jr(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function z(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function He(){this.s=this.s,this.o=this.o}var n_=0;He.prototype.s=!1;He.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),n_!=0)&&Xg(this)};He.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Tl=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function ko(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function hl(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(ri(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function J(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var r_=function(){if(!E.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};E.addEventListener("test",n,e),E.removeEventListener("test",n,e)}catch{}return t}();function Ln(t){return/^[\s\xa0]*$/.test(t)}function ii(){var t=E.navigator;return t&&(t=t.userAgent)?t:""}function ve(t){return ii().indexOf(t)!=-1}function No(t){return No[" "](t),t}No[" "]=function(){};function i_(t,e){var n=W_;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var s_=ve("Opera"),zt=ve("Trident")||ve("MSIE"),Al=ve("Edge"),po=Al||zt,Sl=ve("Gecko")&&!(ii().toLowerCase().indexOf("webkit")!=-1&&!ve("Edge"))&&!(ve("Trident")||ve("MSIE"))&&!ve("Edge"),o_=ii().toLowerCase().indexOf("webkit")!=-1&&!ve("Edge");function bl(){var t=E.document;return t?t.documentMode:void 0}var mo;e:{if(Gr="",Wr=function(){var t=ii();if(Sl)return/rv:([^\);]+)(\)|;)/.exec(t);if(Al)return/Edge\/([\d\.]+)/.exec(t);if(zt)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(o_)return/WebKit\/(\S+)/.exec(t);if(s_)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Wr&&(Gr=Wr?Wr[1]:""),zt&&(Kr=bl(),Kr!=null&&Kr>parseFloat(Gr))){mo=String(Kr);break e}mo=Gr}var Gr,Wr,Kr,go;E.document&&zt?(uo=bl(),go=uo||parseInt(mo,10)||void 0):go=void 0;var uo,a_=go;function Mn(t,e){if(J.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Sl){e:{try{No(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:c_[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Mn.$.h.call(this)}}z(Mn,J);var c_={2:"touch",3:"pen",4:"mouse"};Mn.prototype.h=function(){Mn.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Gn="closure_listenable_"+(1e6*Math.random()|0),u_=0;function l_(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++u_,this.fa=this.ia=!1}function si(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Oo(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function h_(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function Rl(t){let e={};for(let n in t)e[n]=t[n];return e}var dl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pl(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<dl.length;s++)n=dl[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function oi(t){this.src=t,this.g={},this.h=0}oi.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=yo(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new l_(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function _o(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=Tl(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(si(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function yo(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var xo="closure_lm_"+(1e6*Math.random()|0),lo={};function Cl(t,e,n,r,i){if(r&&r.once)return kl(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Cl(t,e[s],n,r,i);return null}return n=Mo(n),t&&t[Gn]?t.O(e,n,jn(r)?!!r.capture:!!r,i):Dl(t,e,n,!1,r,i)}function Dl(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=jn(i)?!!i.capture:!!i,a=Lo(t);if(a||(t[xo]=a=new oi(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=d_(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)r_||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ol(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function d_(){function t(n){return e.call(t.src,t.listener,n)}let e=f_;return t}function kl(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)kl(t,e[s],n,r,i);return null}return n=Mo(n),t&&t[Gn]?t.P(e,n,jn(r)?!!r.capture:!!r,i):Dl(t,e,n,!0,r,i)}function Nl(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Nl(t,e[s],n,r,i);else r=jn(r)?!!r.capture:!!r,n=Mo(n),t&&t[Gn]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=yo(s,n,r,i),-1<n&&(si(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Lo(t))&&(e=t.g[e.toString()],t=-1,e&&(t=yo(e,n,r,i)),(n=-1<t?e[t]:null)&&Vo(n))}function Vo(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Gn])_o(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ol(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lo(e))?(_o(n,t),n.h==0&&(n.src=null,e[xo]=null)):si(t)}}}function Ol(t){return t in lo?lo[t]:lo[t]="on"+t}function f_(t,e){if(t.fa)t=!0;else{e=new Mn(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Vo(t),t=n.call(r,e)}return t}function Lo(t){return t=t[xo],t instanceof oi?t:null}var ho="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mo(t){return typeof t=="function"?t:(t[ho]||(t[ho]=function(e){return t.handleEvent(e)}),t[ho])}function $(){He.call(this),this.i=new oi(this),this.S=this,this.J=null}z($,He);$.prototype[Gn]=!0;$.prototype.removeEventListener=function(t,e,n,r){Nl(this,t,e,n,r)};function H(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new J(e,t);else if(e instanceof J)e.target=e.target||t;else{var i=e;e=new J(r,t),Pl(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Hr(o,r,!0,e)&&i}if(o=e.g=t,i=Hr(o,r,!0,e)&&i,i=Hr(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Hr(o,r,!1,e)&&i}$.prototype.N=function(){if($.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)si(n[r]);delete t.g[e],t.h--}}this.J=null};$.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};$.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Hr(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&_o(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var Fo=E.JSON.stringify,Io=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function p_(){var t=Uo;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var vo=class{constructor(){this.h=this.g=null}add(e,n){let r=xl.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},xl=new Io(()=>new Eo,t=>t.reset()),Eo=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function m_(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function g_(t){E.setTimeout(()=>{throw t},0)}var Fn,Un=!1,Uo=new vo,Vl=()=>{let t=E.Promise.resolve(void 0);Fn=()=>{t.then(__)}},__=()=>{for(var t;t=p_();){try{t.h.call(t.g)}catch(n){g_(n)}var e=xl;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Un=!1};function ai(t,e){$.call(this),this.h=t||1,this.g=e||E,this.j=Q(this.qb,this),this.l=Date.now()}z(ai,$);g=ai.prototype;g.ga=!1;g.T=null;g.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),H(this,"tick"),this.ga&&(qo(this),this.start()))}};g.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function qo(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}g.N=function(){ai.$.N.call(this),qo(this),delete this.g};function Bo(t,e,n){if(typeof t=="function")n&&(t=Q(t,n));else if(t&&typeof t.handleEvent=="function")t=Q(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:E.setTimeout(t,e||0)}function Ll(t){t.g=Bo(()=>{t.g=null,t.i&&(t.i=!1,Ll(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var wo=class extends He{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ll(this)}N(){super.N(),this.g&&(E.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function qn(t){He.call(this),this.h=t,this.g={}}z(qn,He);var fl=[];function Ml(t,e,n,r){Array.isArray(n)||(n&&(fl[0]=n.toString()),n=fl);for(var i=0;i<n.length;i++){var s=Cl(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Fl(t){Oo(t.g,function(e,n){this.g.hasOwnProperty(n)&&Vo(e)},t),t.g={}}qn.prototype.N=function(){qn.$.N.call(this),Fl(this)};qn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ci(){this.g=!0}ci.prototype.Ea=function(){this.g=!1};function y_(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function I_(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Bt(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+E_(t,n)+(r?" "+r:"")})}function v_(t,e){t.info(function(){return"TIMEOUT: "+e})}ci.prototype.info=function(){};function E_(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Fo(n)}catch{return e}}var _t={},pl=null;function ui(){return pl=pl||new $}_t.Ta="serverreachability";function Ul(t){J.call(this,_t.Ta,t)}z(Ul,J);function Bn(t){let e=ui();H(e,new Ul(e))}_t.STAT_EVENT="statevent";function ql(t,e){J.call(this,_t.STAT_EVENT,t),this.stat=e}z(ql,J);function ne(t){let e=ui();H(e,new ql(e,t))}_t.Ua="timingevent";function Bl(t,e){J.call(this,_t.Ua,t),this.size=e}z(Bl,J);function Wn(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return E.setTimeout(function(){t()},e)}var li={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},$l={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function $o(){}$o.prototype.h=null;function ml(t){return t.h||(t.h=t.i())}function zl(){}var Kn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function zo(){J.call(this,"d")}z(zo,J);function jo(){J.call(this,"c")}z(jo,J);var To;function hi(){}z(hi,$o);hi.prototype.g=function(){return new XMLHttpRequest};hi.prototype.i=function(){return{}};To=new hi;function Hn(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new qn(this),this.P=w_,t=po?125:void 0,this.V=new ai(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new jl}function jl(){this.i=null,this.g="",this.h=!1}var w_=45e3,Gl={},Ao={};g=Hn.prototype;g.setTimeout=function(t){this.P=t};function So(t,e,n){t.L=1,t.A=fi(xe(e)),t.u=n,t.S=!0,Wl(t,null)}function Wl(t,e){t.G=Date.now(),Qn(t),t.B=xe(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),eh(n.i,"t",r),t.o=0,n=t.l.J,t.h=new jl,t.g=Eh(t.l,n?e:null,!t.u),0<t.O&&(t.M=new wo(Q(t.Pa,t,t.g),t.O)),Ml(t.U,t.g,"readystatechange",t.nb),e=t.I?Rl(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Bn(),y_(t.j,t.v,t.B,t.m,t.W,t.u)}g.nb=function(t){t=t.target;let e=this.M;e&&Ee(t)==3?e.l():this.Pa(t)};g.Pa=function(t){try{if(t==this.g)e:{let l=Ee(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||po||this.g&&(this.h.h||this.g.ja()||Il(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Bn(3):Bn(2)),di(this);var n=this.g.da();this.ca=n;t:if(Kl(this)){var r=Il(this.g);t="";var i=r.length,s=Ee(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pt(this),Vn(this);var o="";break t}this.h.i=new E.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,I_(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ln(a)){var u=a;break t}}u=null}if(n=u)Bt(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,bo(this,n);else{this.i=!1,this.s=3,ne(12),pt(this),Vn(this);break e}}this.S?(Hl(this,l,o),po&&this.i&&l==3&&(Ml(this.U,this.V,"tick",this.mb),this.V.start())):(Bt(this.j,this.m,o,null),bo(this,o)),l==4&&pt(this),this.i&&!this.J&&(l==4?_h(this.l,this):(this.i=!1,Qn(this)))}else z_(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,ne(12)):(this.s=0,ne(13)),pt(this),Vn(this)}}}catch{}finally{}};function Kl(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function Hl(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=T_(t,n),i==Ao){e==4&&(t.s=4,ne(14),r=!1),Bt(t.j,t.m,null,"[Incomplete Response]");break}else if(i==Gl){t.s=4,ne(15),Bt(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Bt(t.j,t.m,i,null),bo(t,i);Kl(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,ne(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jo(e),e.M=!0,ne(11))):(Bt(t.j,t.m,n,"[Invalid Chunked Response]"),pt(t),Vn(t))}g.mb=function(){if(this.g){var t=Ee(this.g),e=this.g.ja();this.o<e.length&&(di(this),Hl(this,t,e),this.i&&t!=4&&Qn(this))}};function T_(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Ao:(n=Number(e.substring(n,r)),isNaN(n)?Gl:(r+=1,r+n>e.length?Ao:(e=e.slice(r,r+n),t.o=r+n,e)))}g.cancel=function(){this.J=!0,pt(this)};function Qn(t){t.Y=Date.now()+t.P,Ql(t,t.P)}function Ql(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Wn(Q(t.lb,t),e)}function di(t){t.C&&(E.clearTimeout(t.C),t.C=null)}g.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(v_(this.j,this.B),this.L!=2&&(Bn(),ne(17)),pt(this),this.s=2,Vn(this)):Ql(this,this.Y-t)};function Vn(t){t.l.H==0||t.J||_h(t.l,t)}function pt(t){di(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,qo(t.V),Fl(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function bo(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Ro(n.i,t))){if(!t.K&&Ro(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Zr(n),gi(n);else break e;Qo(n),ne(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Wn(Q(n.ib,n),6e3));if(1>=rh(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else mt(n,11)}else if((t.K||n.g==t)&&Zr(n),!Ln(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=u[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let p=u[5];p!=null&&typeof p=="number"&&0<p&&(r=1.5*p,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let _=t.g;if(_){let S=_.g?_.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(S){var s=r.i;s.g||S.indexOf("spdy")==-1&&S.indexOf("quic")==-1&&S.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Go(s,s.h),s.h=null))}if(r.F){let C=_.g?_.g.getResponseHeader("X-HTTP-Session-Id"):null;C&&(r.Da=C,k(r.I,r.F,C))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=vh(r,r.J?r.pa:null,r.Y),o.K){ih(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(di(a),Qn(a)),r.g=o}else mh(r);0<n.j.length&&_i(n)}else u[0]!="stop"&&u[0]!="close"||mt(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?mt(n,7):Ho(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Bn(4)}catch{}}function A_(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(ri(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function S_(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(ri(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function Jl(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(ri(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=S_(t),r=A_(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var Yl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function b_(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function gt(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof gt){this.h=t.h,Yr(this,t.j),this.s=t.s,this.g=t.g,Xr(this,t.m),this.l=t.l;var e=t.i,n=new $n;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),gl(this,n),this.o=t.o}else t&&(e=String(t).match(Yl))?(this.h=!1,Yr(this,e[1]||"",!0),this.s=On(e[2]||""),this.g=On(e[3]||"",!0),Xr(this,e[4]),this.l=On(e[5]||"",!0),gl(this,e[6]||"",!0),this.o=On(e[7]||"")):(this.h=!1,this.i=new $n(null,this.h))}gt.prototype.toString=function(){var t=[],e=this.j;e&&t.push(xn(e,_l,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(xn(e,_l,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(xn(n,n.charAt(0)=="/"?C_:P_,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",xn(n,k_)),t.join("")};function xe(t){return new gt(t)}function Yr(t,e,n){t.j=n?On(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Xr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function gl(t,e,n){e instanceof $n?(t.i=e,N_(t.i,t.h)):(n||(e=xn(e,D_)),t.i=new $n(e,t.h))}function k(t,e,n){t.i.set(e,n)}function fi(t){return k(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function On(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function xn(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,R_),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function R_(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var _l=/[#\/\?@]/g,P_=/[#\?:]/g,C_=/[#\?]/g,D_=/[#\?@]/g,k_=/#/g;function $n(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Qe(t){t.g||(t.g=new Map,t.h=0,t.i&&b_(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}g=$n.prototype;g.add=function(t,e){Qe(this),this.i=null,t=jt(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Xl(t,e){Qe(t),e=jt(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Zl(t,e){return Qe(t),e=jt(t,e),t.g.has(e)}g.forEach=function(t,e){Qe(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};g.ta=function(){Qe(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};g.Z=function(t){Qe(this);let e=[];if(typeof t=="string")Zl(this,t)&&(e=e.concat(this.g.get(jt(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};g.set=function(t,e){return Qe(this),this.i=null,t=jt(this,t),Zl(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};g.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function eh(t,e,n){Xl(t,e),0<n.length&&(t.i=null,t.g.set(jt(t,e),ko(n)),t.h+=n.length)}g.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function jt(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function N_(t,e){e&&!t.j&&(Qe(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(Xl(this,r),eh(this,i,n))},t)),t.j=e}var O_=class{constructor(t,e){this.g=t,this.map=e}};function th(t){this.l=t||x_,E.PerformanceNavigationTiming?(t=E.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(E.g&&E.g.Ka&&E.g.Ka()&&E.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var x_=10;function nh(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function rh(t){return t.h?1:t.g?t.g.size:0}function Ro(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Go(t,e){t.g?t.g.add(e):t.h=e}function ih(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}th.prototype.cancel=function(){if(this.i=sh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function sh(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return ko(t.i)}var V_=class{stringify(t){return E.JSON.stringify(t,void 0)}parse(t){return E.JSON.parse(t,void 0)}};function L_(){this.g=new V_}function M_(t,e,n){let r=n||"";try{Jl(t,function(i,s){let o=i;jn(i)&&(o=Fo(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function F_(t,e){let n=new ci;if(E.Image){let r=new Image;r.onload=jr(Qr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=jr(Qr,n,r,"TestLoadImage: error",!1,e),r.onabort=jr(Qr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=jr(Qr,n,r,"TestLoadImage: timeout",!1,e),E.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Qr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Jn(t){this.l=t.ec||null,this.j=t.ob||!1}z(Jn,$o);Jn.prototype.g=function(){return new pi(this.l,this.j)};Jn.prototype.i=function(t){return function(){return t}}({});function pi(t,e){$.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Wo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}z(pi,$);var Wo=0;g=pi.prototype;g.open=function(t,e){if(this.readyState!=Wo)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,zn(this)};g.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||E).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};g.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Yn(this)),this.readyState=Wo};g.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,zn(this)),this.g&&(this.readyState=3,zn(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof E.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;oh(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function oh(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}g.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Yn(this):zn(this),this.readyState==3&&oh(this)}};g.Za=function(t){this.g&&(this.response=this.responseText=t,Yn(this))};g.Ya=function(t){this.g&&(this.response=t,Yn(this))};g.ka=function(){this.g&&Yn(this)};function Yn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,zn(t)}g.setRequestHeader=function(t,e){this.v.append(t,e)};g.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};g.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function zn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var U_=E.JSON.parse;function O(t){$.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ah,this.L=this.M=!1}z(O,$);var ah="",q_=/^https?$/i,B_=["POST","PUT"];g=O.prototype;g.Oa=function(t){this.M=t};g.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():To.g(),this.C=this.u?ml(this.u):ml(To),this.g.onreadystatechange=Q(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){yl(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=E.FormData&&t instanceof E.FormData,!(0<=Tl(B_,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{lh(this),0<this.B&&((this.L=$_(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Q(this.ua,this)):this.A=Bo(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){yl(this,s)}};function $_(t){return zt&&typeof t.timeout=="number"&&t.ontimeout!==void 0}g.ua=function(){typeof Do<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,H(this,"timeout"),this.abort(8))};function yl(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ch(t),mi(t)}function ch(t){t.F||(t.F=!0,H(t,"complete"),H(t,"error"))}g.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,H(this,"complete"),H(this,"abort"),mi(this))};g.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),mi(this,!0)),O.$.N.call(this)};g.La=function(){this.s||(this.G||this.v||this.l?uh(this):this.kb())};g.kb=function(){uh(this)};function uh(t){if(t.h&&typeof Do<"u"&&(!t.C[1]||Ee(t)!=4||t.da()!=2)){if(t.v&&Ee(t)==4)Bo(t.La,0,t);else if(H(t,"readystatechange"),Ee(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(Yl)[1]||null;!i&&E.self&&E.self.location&&(i=E.self.location.protocol.slice(0,-1)),r=!q_.test(i?i.toLowerCase():"")}n=r}if(n)H(t,"complete"),H(t,"success");else{t.m=6;try{var s=2<Ee(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",ch(t)}}finally{mi(t)}}}}function mi(t,e){if(t.g){lh(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||H(t,"ready");try{n.onreadystatechange=r}catch{}}}function lh(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(E.clearTimeout(t.A),t.A=null)}g.isActive=function(){return!!this.g};function Ee(t){return t.g?t.g.readyState:0}g.da=function(){try{return 2<Ee(this)?this.g.status:-1}catch{return-1}};g.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};g.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),U_(e)}};function Il(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case ah:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function z_(t){let e={};t=(t.g&&2<=Ee(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Ln(t[r]))continue;var n=m_(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}h_(e,function(r){return r.join(", ")})}g.Ia=function(){return this.m};g.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function hh(t){let e="";return Oo(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Ko(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=hh(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):k(t,e,n))}function kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function dh(t){this.Ga=0,this.j=[],this.l=new ci,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=kn("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=kn("baseRetryDelayMs",5e3,t),this.hb=kn("retryDelaySeedMs",1e4,t),this.eb=kn("forwardChannelMaxRetries",2,t),this.xa=kn("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new th(t&&t.concurrentRequestLimit),this.Ja=new L_,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}g=dh.prototype;g.ra=8;g.H=1;function Ho(t){if(fh(t),t.H==3){var e=t.W++,n=xe(t.I);if(k(n,"SID",t.K),k(n,"RID",e),k(n,"TYPE","terminate"),Xn(t,n),e=new Hn(t,t.l,e),e.L=2,e.A=fi(xe(n)),n=!1,E.navigator&&E.navigator.sendBeacon)try{n=E.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&E.Image&&(new Image().src=e.A,n=!0),n||(e.g=Eh(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Qn(e)}Ih(t)}function gi(t){t.g&&(Jo(t),t.g.cancel(),t.g=null)}function fh(t){gi(t),t.u&&(E.clearTimeout(t.u),t.u=null),Zr(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&E.clearTimeout(t.m),t.m=null)}function _i(t){if(!nh(t.i)&&!t.m){t.m=!0;var e=t.Na;Fn||Vl(),Un||(Fn(),Un=!0),Uo.add(e,t),t.C=0}}function j_(t,e){return rh(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Wn(Q(t.Na,t,e),yh(t,t.C)),t.C++,!0)}g.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Hn(this,this.l,t),s=this.s;if(this.U&&(s?(s=Rl(s),Pl(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=ph(this,i,e),n=xe(this.I),k(n,"RID",t),k(n,"CVER",22),this.F&&k(n,"X-HTTP-Session-Id",this.F),Xn(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(hh(s)))+"&"+e:this.o&&Ko(n,this.o,s)),Go(this.i,i),this.bb&&k(n,"TYPE","init"),this.P?(k(n,"$req",e),k(n,"SID","null"),i.aa=!0,So(i,n,null)):So(i,n,e),this.H=2}}else this.H==3&&(t?vl(this,t):this.j.length==0||nh(this.i)||vl(this))};function vl(t,e){var n;e?n=e.m:n=t.W++;let r=xe(t.I);k(r,"SID",t.K),k(r,"RID",n),k(r,"AID",t.V),Xn(t,r),t.o&&t.s&&Ko(r,t.o,t.s),n=new Hn(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=ph(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Go(t.i,n),So(n,r,e)}function Xn(t,e){t.na&&Oo(t.na,function(n,r){k(e,r,n)}),t.h&&Jl({},function(n,r){k(e,r,n)})}function ph(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Q(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{M_(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function mh(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Fn||Vl(),Un||(Fn(),Un=!0),Uo.add(e,t),t.A=0}}function Qo(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Wn(Q(t.Ma,t),yh(t,t.A)),t.A++,!0)}g.Ma=function(){if(this.u=null,gh(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Wn(Q(this.jb,this),t)}};g.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ne(10),gi(this),gh(this))};function Jo(t){t.B!=null&&(E.clearTimeout(t.B),t.B=null)}function gh(t){t.g=new Hn(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=xe(t.wa);k(e,"RID","rpc"),k(e,"SID",t.K),k(e,"AID",t.V),k(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&k(e,"TO",t.qa),k(e,"TYPE","xmlhttp"),Xn(t,e),t.o&&t.s&&Ko(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=fi(xe(e)),n.u=null,n.S=!0,Wl(n,t)}g.ib=function(){this.v!=null&&(this.v=null,gi(this),Qo(this),ne(19))};function Zr(t){t.v!=null&&(E.clearTimeout(t.v),t.v=null)}function _h(t,e){var n=null;if(t.g==e){Zr(t),Jo(t),t.g=null;var r=2}else if(Ro(t.i,e))n=e.F,ih(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=ui(),H(r,new Bl(r,n)),_i(t)}else mh(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&j_(t,e)||r==2&&Qo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:mt(t,5);break;case 4:mt(t,10);break;case 3:mt(t,6);break;default:mt(t,2)}}}function yh(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function mt(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Q(t.pb,t);n||(n=new gt("//www.google.com/images/cleardot.gif"),E.location&&E.location.protocol=="http"||Yr(n,"https"),fi(n)),F_(n.toString(),r)}else ne(2);t.H=0,t.h&&t.h.za(e),Ih(t),fh(t)}g.pb=function(t){t?(this.l.info("Successfully pinged google.com"),ne(2)):(this.l.info("Failed to ping google.com"),ne(1))};function Ih(t){if(t.H=0,t.ma=[],t.h){let e=sh(t.i);(e.length!=0||t.j.length!=0)&&(hl(t.ma,e),hl(t.ma,t.j),t.i.i.length=0,ko(t.j),t.j.length=0),t.h.ya()}}function vh(t,e,n){var r=n instanceof gt?xe(n):new gt(n);if(r.g!="")e&&(r.g=e+"."+r.g),Xr(r,r.m);else{var i=E.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new gt(null);r&&Yr(s,r),e&&(s.g=e),i&&Xr(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&k(r,n,e),k(r,"VER",t.ra),Xn(t,r),r}function Eh(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new O(new Jn({ob:n})):new O(t.va),e.Oa(t.J),e}g.isActive=function(){return!!this.h&&this.h.isActive(this)};function wh(){}g=wh.prototype;g.Ba=function(){};g.Aa=function(){};g.za=function(){};g.ya=function(){};g.isActive=function(){return!0};g.Va=function(){};function ei(){if(zt&&!(10<=Number(a_)))throw Error("Environmental error: no available transport.")}ei.prototype.g=function(t,e){return new se(t,e)};function se(t,e){$.call(this),this.g=new dh(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Ln(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ln(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Gt(this)}z(se,$);se.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;ne(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=vh(t,null,t.Y),_i(t)};se.prototype.close=function(){Ho(this.g)};se.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Fo(t),t=n);e.j.push(new O_(e.fb++,t)),e.H==3&&_i(e)};se.prototype.N=function(){this.g.h=null,delete this.j,Ho(this.g),delete this.g,se.$.N.call(this)};function Th(t){zo.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}z(Th,zo);function Ah(){jo.call(this),this.status=1}z(Ah,jo);function Gt(t){this.g=t}z(Gt,wh);Gt.prototype.Ba=function(){H(this.g,"a")};Gt.prototype.Aa=function(t){H(this.g,new Th(t))};Gt.prototype.za=function(t){H(this.g,new Ah)};Gt.prototype.ya=function(){H(this.g,"b")};function G_(){this.blockSize=-1}function pe(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}z(pe,G_);pe.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function fo(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}pe.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)fo(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){fo(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){fo(this,r),i=0;break}}this.h=i,this.i+=e};pe.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function P(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var W_={};function Yo(t){return-128<=t&&128>t?i_(t,function(e){return new P([e|0],0>e?-1:0)}):new P([t|0],0>t?-1:0)}function we(t){if(isNaN(t)||!isFinite(t))return $t;if(0>t)return K(we(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Po;return new P(e,0)}function Sh(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return K(Sh(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=we(Math.pow(e,8)),r=$t,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=we(Math.pow(e,s)),r=r.R(s).add(we(o))):(r=r.R(n),r=r.add(we(o)))}return r}var Po=4294967296,$t=Yo(0),Co=Yo(1),El=Yo(16777216);g=P.prototype;g.ea=function(){if(de(this))return-K(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Po+r)*e,e*=Po}return t};g.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Oe(this))return"0";if(de(this))return"-"+K(this).toString(t);for(var e=we(Math.pow(t,6)),n=this,r="";;){var i=ni(n,e).g;n=ti(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Oe(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};g.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Oe(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function de(t){return t.h==-1}g.X=function(t){return t=ti(this,t),de(t)?-1:Oe(t)?0:1};function K(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new P(n,~t.h).add(Co)}g.abs=function(){return de(this)?K(this):this};g.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new P(n,n[n.length-1]&-2147483648?-1:0)};function ti(t,e){return t.add(K(e))}g.R=function(t){if(Oe(this)||Oe(t))return $t;if(de(this))return de(t)?K(this).R(K(t)):K(K(this).R(t));if(de(t))return K(this.R(K(t)));if(0>this.X(El)&&0>t.X(El))return we(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,Jr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Jr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Jr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Jr(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new P(n,0)};function Jr(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Nn(t,e){this.g=t,this.h=e}function ni(t,e){if(Oe(e))throw Error("division by zero");if(Oe(t))return new Nn($t,$t);if(de(t))return e=ni(K(t),e),new Nn(K(e.g),K(e.h));if(de(e))return e=ni(t,K(e)),new Nn(K(e.g),e.h);if(30<t.g.length){if(de(t)||de(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Co,r=e;0>=r.X(t);)n=wl(n),r=wl(r);var i=qt(n,1),s=qt(r,1);for(r=qt(r,2),n=qt(n,2);!Oe(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=qt(r,1),n=qt(n,1)}return e=ti(t,i.R(e)),new Nn(i,e)}for(i=$t;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=we(n),o=s.R(e);de(o)||0<o.X(t);)n-=r,s=we(n),o=s.R(e);Oe(s)&&(s=Co),i=i.add(s),t=ti(t,o)}return new Nn(i,t)}g.gb=function(t){return ni(this,t).h};g.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new P(n,this.h&t.h)};g.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new P(n,this.h|t.h)};g.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new P(n,this.h^t.h)};function wl(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new P(n,t.h)}function qt(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new P(i,t.h)}ei.prototype.createWebChannel=ei.prototype.g;se.prototype.send=se.prototype.u;se.prototype.open=se.prototype.m;se.prototype.close=se.prototype.close;li.NO_ERROR=0;li.TIMEOUT=8;li.HTTP_ERROR=6;$l.COMPLETE="complete";zl.EventType=Kn;Kn.OPEN="a";Kn.CLOSE="b";Kn.ERROR="c";Kn.MESSAGE="d";$.prototype.listen=$.prototype.O;O.prototype.listenOnce=O.prototype.P;O.prototype.getLastError=O.prototype.Sa;O.prototype.getLastErrorCode=O.prototype.Ia;O.prototype.getStatus=O.prototype.da;O.prototype.getResponseJson=O.prototype.Wa;O.prototype.getResponseText=O.prototype.ja;O.prototype.send=O.prototype.ha;O.prototype.setWithCredentials=O.prototype.Oa;pe.prototype.digest=pe.prototype.l;pe.prototype.reset=pe.prototype.reset;pe.prototype.update=pe.prototype.j;P.prototype.add=P.prototype.add;P.prototype.multiply=P.prototype.R;P.prototype.modulo=P.prototype.gb;P.prototype.compare=P.prototype.X;P.prototype.toNumber=P.prototype.ea;P.prototype.toString=P.prototype.toString;P.prototype.getBits=P.prototype.D;P.fromNumber=we;P.fromString=Sh;var bh=me.createWebChannelTransport=function(){return new ei},Rh=me.getStatEventTarget=function(){return ui()},yi=me.ErrorCode=li,Ph=me.EventType=$l,Ch=me.Event=_t,Xo=me.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Dh=me.FetchXmlHttpFactory=Jn,Zn=me.WebChannel=zl,kh=me.XhrIo=O,K_=me.Md5=pe,Nh=me.Integer=P;var Oh="@firebase/firestore";var j=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};j.UNAUTHENTICATED=new j(null),j.GOOGLE_CREDENTIALS=new j("google-credentials-uid"),j.FIRST_PARTY=new j("first-party-uid"),j.MOCK_USER=new j("mock-user");var ln="10.11.1";var Et=new qe("@firebase/firestore");function er(){return Et.logLevel}function y(t,...e){if(Et.logLevel<=T.DEBUG){let n=e.map(Ic);Et.debug(`Firestore (${ln}): ${t}`,...n)}}function wt(t,...e){if(Et.logLevel<=T.ERROR){let n=e.map(Ic);Et.error(`Firestore (${ln}): ${t}`,...n)}}function Ai(t,...e){if(Et.logLevel<=T.WARN){let n=e.map(Ic);Et.warn(`Firestore (${ln}): ${t}`,...n)}}function Ic(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function A(t="Unexpected state"){let e=`FIRESTORE (${ln}) INTERNAL ASSERTION FAILED: `+t;throw wt(e),new Error(e)}function W(t,e){t||A()}function N(t,e){return t}var f={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=class extends ie{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ve=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Si=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},na=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(j.UNAUTHENTICATED))}shutdown(){}},ra=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},ia=class{constructor(e){this.t=e,this.currentUser=j.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new Ve;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ve,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>h(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(y("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ve)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(W(typeof r.accessToken=="string"),new Si(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return W(e===null||typeof e=="string"),new j(e)}},sa=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=j.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},oa=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new sa(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(j.FIRST_PARTY))}shutdown(){}invalidateToken(){}},aa=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ca=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(W(typeof n.token=="string"),this.R=n.token,new aa(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function H_(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var bi=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=H_(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function D(t,e){return t<e?-1:t>e?1:0}function Qt(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}var Z=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?D(this.nanoseconds,e.nanoseconds):D(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var x=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Z(0,0))}static max(){return new t(new Z(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ri=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&A(),r===void 0?r=e.length-n:r>e.length-n&&A(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},M=class t extends Ri{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new I(f.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},Q_=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oe=class t extends Ri{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return Q_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new I(f.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new I(f.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new I(f.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new I(f.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var w=class t{constructor(e){this.path=e}static fromPath(e){return new t(M.fromString(e))}static fromName(e){return new t(M.fromString(e).popFirst(5))}static empty(){return new t(M.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&M.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return M.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new M(e.slice()))}};var ua=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};ua.UNKNOWN_ID=-1;function J_(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=x.fromTimestamp(r===1e9?new Z(n+1,0):new Z(n,r));return new Tt(i,w.empty(),e)}function Y_(t){return new Tt(t.readTime,t.key,-1)}var Tt=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(x.min(),w.empty(),-1)}static max(){return new t(x.max(),w.empty(),-1)}};function X_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=w.comparator(t.documentKey,e.documentKey),n!==0?n:D(t.largestBatchId,e.largestBatchId))}var Z_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",la=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Zh(t){return h(this,null,function*(){if(t.code!==f.FAILED_PRECONDITION||t.message!==Z_)throw t;y("LocalStore","Unexpectedly lost primary lease")})}var m=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&A(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};function ey(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Gi(t){return t.name==="IndexedDbTransactionError"}var ty=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function vc(t){return t==null}function or(t){return t===0&&1/t==-1/0}function ny(t){return typeof t=="number"&&Number.isInteger(t)&&!or(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ry=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],TE=[...ry,"documentOverlays"],iy=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],sy=iy,AE=[...sy,"indexConfiguration","indexState","indexEntries"];function xh(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lr(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ed(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ae=class t{constructor(e,n){this.comparator=e,this.root=n||be.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,be.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,be.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kt(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kt(this.root,e,this.comparator,!0)}},Kt=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},be=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw A();let e=this.left.check();if(e!==this.right.check())throw A();return e+(this.isRed()?0:1)}};be.EMPTY=null,be.RED=!0,be.BLACK=!1;be.EMPTY=new class{constructor(){this.size=0}get key(){throw A()}get value(){throw A()}get color(){throw A()}get left(){throw A()}get right(){throw A()}copy(e,n,r,i,s){return this}insert(e,n,r){return new be(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var re=class t{constructor(e){this.comparator=e,this.data=new ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Pi(this.data.getIterator())}getIteratorFrom(e){return new Pi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Pi=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Se=class t{constructor(e){this.fields=e,e.sort(oe.comparator)}static empty(){return new t([])}unionWith(e){let n=new re(oe.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Qt(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var ha=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ye=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ha("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return D(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ye.EMPTY_BYTE_STRING=new Ye("");var oy=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xe(t){if(W(!!t),typeof t=="string"){let e=0,n=oy.exec(t);if(W(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:q(t.seconds),nanos:q(t.nanos)}}function q(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Jt(t){return typeof t=="string"?Ye.fromBase64String(t):Ye.fromUint8Array(t)}function Ec(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function td(t){let e=t.mapValue.fields.__previous_value__;return Ec(e)?td(e):e}function Ci(t){let e=Xe(t.mapValue.fields.__local_write_time__.timestampValue);return new Z(e.seconds,e.nanos)}var da=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},fa=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Ii={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Yt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ec(t)?4:nd(t)?9007199254740991:10:A()}function Re(t,e){if(t===e)return!0;let n=Yt(t);if(n!==Yt(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ci(t).isEqual(Ci(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Xe(i.timestampValue),a=Xe(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Jt(i.bytesValue).isEqual(Jt(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return q(i.geoPointValue.latitude)===q(s.geoPointValue.latitude)&&q(i.geoPointValue.longitude)===q(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return q(i.integerValue)===q(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=q(i.doubleValue),a=q(s.doubleValue);return o===a?or(o)===or(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Qt(t.arrayValue.values||[],e.arrayValue.values||[],Re);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(xh(o)!==xh(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Re(o[c],a[c])))return!1;return!0}(t,e);default:return A()}}function ar(t,e){return(t.values||[]).find(n=>Re(n,e))!==void 0}function Xt(t,e){if(t===e)return 0;let n=Yt(t),r=Yt(e);if(n!==r)return D(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return D(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=q(s.integerValue||s.doubleValue),c=q(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return Vh(t.timestampValue,e.timestampValue);case 4:return Vh(Ci(t),Ci(e));case 5:return D(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Jt(s),c=Jt(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=D(a[u],c[u]);if(l!==0)return l}return D(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=D(q(s.latitude),q(o.latitude));return a!==0?a:D(q(s.longitude),q(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=Xt(a[u],c[u]);if(l)return l}return D(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ii.mapValue&&o===Ii.mapValue)return 0;if(s===Ii.mapValue)return 1;if(o===Ii.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let d=0;d<c.length&&d<l.length;++d){let p=D(c[d],l[d]);if(p!==0)return p;let _=Xt(a[c[d]],u[l[d]]);if(_!==0)return _}return D(c.length,l.length)}(t.mapValue,e.mapValue);default:throw A()}}function Vh(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return D(t,e);let n=Xe(t),r=Xe(e),i=D(n.seconds,r.seconds);return i!==0?i:D(n.nanos,r.nanos)}function Zt(t){return pa(t)}function pa(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Xe(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Jt(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return w.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=pa(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${pa(n.fields[o])}`;return i+"}"}(t.mapValue):A()}function ma(t){return!!t&&"integerValue"in t}function wc(t){return!!t&&"arrayValue"in t}function wi(t){return!!t&&"mapValue"in t}function nr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return lr(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=nr(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=nr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function nd(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ae=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!wi(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=nr(n)}setAll(e){let n=oe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=nr(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());wi(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Re(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];wi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){lr(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(nr(this.value))}};function rd(t){let e=[];return lr(t.fields,(n,r)=>{let i=new oe([n]);if(wi(r)){let s=rd(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Se(e)}var en=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,x.min(),x.min(),x.min(),Ae.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,x.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,x.min(),x.min(),Ae.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,x.min(),x.min(),Ae.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(x.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ae.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ae.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=x.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var tn=class{constructor(e,n){this.position=e,this.inclusive=n}};function Lh(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=w.comparator(w.fromName(o.referenceValue),n.key):r=Xt(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mh(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Re(t.position[n],e.position[n]))return!1;return!0}var nn=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function ay(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Di=class{},G=class t extends Di{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new _a(e,n,r):n==="array-contains"?new va(e,r):n==="in"?new Ea(e,r):n==="not-in"?new wa(e,r):n==="array-contains-any"?new Ta(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new ya(e,r):new Ia(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Xt(n,this.value)):n!==null&&Yt(this.value)===Yt(n)&&this.matchesComparison(Xt(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return A()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ze=class t extends Di{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return id(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function id(t){return t.op==="and"}function sd(t){return cy(t)&&id(t)}function cy(t){for(let e of t.filters)if(e instanceof Ze)return!1;return!0}function ga(t){if(t instanceof G)return t.field.canonicalString()+t.op.toString()+Zt(t.value);if(sd(t))return t.filters.map(e=>ga(e)).join(",");{let e=t.filters.map(n=>ga(n)).join(",");return`${t.op}(${e})`}}function od(t,e){return t instanceof G?function(r,i){return i instanceof G&&r.op===i.op&&r.field.isEqual(i.field)&&Re(r.value,i.value)}(t,e):t instanceof Ze?function(r,i){return i instanceof Ze&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&od(o,i.filters[a]),!0):!1}(t,e):void A()}function ad(t){return t instanceof G?function(n){return`${n.field.canonicalString()} ${n.op} ${Zt(n.value)}`}(t):t instanceof Ze?function(n){return n.op.toString()+" {"+n.getFilters().map(ad).join(" ,")+"}"}(t):"Filter"}var _a=class extends G{constructor(e,n,r){super(e,n,r),this.key=w.fromName(r.referenceValue)}matches(e){let n=w.comparator(e.key,this.key);return this.matchesComparison(n)}},ya=class extends G{constructor(e,n){super(e,"in",n),this.keys=cd("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},Ia=class extends G{constructor(e,n){super(e,"not-in",n),this.keys=cd("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function cd(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>w.fromName(r.referenceValue))}var va=class extends G{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return wc(n)&&ar(n.arrayValue,this.value)}},Ea=class extends G{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&ar(this.value.arrayValue,n)}},wa=class extends G{constructor(e,n){super(e,"not-in",n)}matches(e){if(ar(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!ar(this.value.arrayValue,n)}},Ta=class extends G{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!wc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ar(this.value.arrayValue,r))}};var Aa=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function Fh(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Aa(t,e,n,r,i,s,o)}function Tc(t){let e=N(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ga(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),vc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Zt(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Zt(r)).join(",")),e.ue=n}return e.ue}function Ac(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ay(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!od(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Mh(t.startAt,e.startAt)&&Mh(t.endAt,e.endAt)}var rn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function uy(t,e,n,r,i,s,o,a){return new rn(t,e,n,r,i,s,o,a)}function ly(t){return new rn(t)}function Uh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function hy(t){return t.collectionGroup!==null}function rr(t){let e=N(t);if(e.ce===null){e.ce=[];let n=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new re(oe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new nn(s,r))}),n.has(oe.keyField().canonicalString())||e.ce.push(new nn(oe.keyField(),r))}return e.ce}function It(t){let e=N(t);return e.le||(e.le=dy(e,rr(t))),e.le}function dy(t,e){if(t.limitType==="F")return Fh(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new nn(i.field,s)});let n=t.endAt?new tn(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new tn(t.startAt.position,t.startAt.inclusive):null;return Fh(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Sa(t,e,n){return new rn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ud(t,e){return Ac(It(t),It(e))&&t.limitType===e.limitType}function ld(t){return`${Tc(It(t))}|lt:${t.limitType}`}function tr(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>ad(i)).join(", ")}]`),vc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Zt(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Zt(i)).join(",")),`Target(${r})`}(It(t))}; limitType=${t.limitType})`}function Sc(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):w.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of rr(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=Lh(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,rr(r),i)||r.endAt&&!function(o,a,c){let u=Lh(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,rr(r),i))}(t,e)}function fy(t){return(e,n)=>{let r=!1;for(let i of rr(t)){let s=py(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function py(t,e,n){let r=t.field.isKeyField()?w.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Xt(c,u):A()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return A()}}var et=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lr(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return ed(this.inner)}size(){return this.innerSize}};var my=new ae(w.comparator);function ki(){return my}var hd=new ae(w.comparator);function vi(...t){let e=hd;for(let n of t)e=e.insert(n.key,n);return e}function dd(t){let e=hd;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function yt(){return ir()}function fd(){return ir()}function ir(){return new et(t=>t.toString(),(t,e)=>t.isEqual(e))}var gy=new ae(w.comparator),_y=new re(w.comparator);function X(...t){let e=_y;for(let n of t)e=e.add(n);return e}var yy=new re(D);function Iy(){return yy}function pd(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:or(e)?"-0":e}}function md(t){return{integerValue:""+t}}function vy(t,e){return ny(e)?md(e):pd(t,e)}var sn=class{constructor(){this._=void 0}};function Ey(t,e,n){return t instanceof on?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ec(s)&&(s=td(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof At?_d(t,e):t instanceof St?yd(t,e):function(i,s){let o=gd(i,s),a=qh(o)+qh(i.Pe);return ma(o)&&ma(i.Pe)?md(a):pd(i.serializer,a)}(t,e)}function wy(t,e,n){return t instanceof At?_d(t,e):t instanceof St?yd(t,e):n}function gd(t,e){return t instanceof an?function(r){return ma(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var on=class extends sn{},At=class extends sn{constructor(e){super(),this.elements=e}};function _d(t,e){let n=Id(e);for(let r of t.elements)n.some(i=>Re(i,r))||n.push(r);return{arrayValue:{values:n}}}var St=class extends sn{constructor(e){super(),this.elements=e}};function yd(t,e){let n=Id(e);for(let r of t.elements)n=n.filter(i=>!Re(i,r));return{arrayValue:{values:n}}}var an=class extends sn{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function qh(t){return q(t.integerValue||t.doubleValue)}function Id(t){return wc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ty(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof At&&i instanceof At||r instanceof St&&i instanceof St?Qt(r.elements,i.elements,Re):r instanceof an&&i instanceof an?Re(r.Pe,i.Pe):r instanceof on&&i instanceof on}(t.transform,e.transform)}var ba=class{constructor(e,n){this.version=e,this.transformResults=n}},vt=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ti(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var cn=class{};function vd(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ni(t.key,vt.none()):new bt(t.key,t.data,vt.none());{let n=t.data,r=Ae.empty(),i=new re(oe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Me(t.key,r,new Se(i.toArray()),vt.none())}}function Ay(t,e,n){t instanceof bt?function(i,s,o){let a=i.value.clone(),c=$h(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Me?function(i,s,o){if(!Ti(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=$h(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Ed(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function sr(t,e,n,r){return t instanceof bt?function(s,o,a,c){if(!Ti(s.precondition,o))return a;let u=s.value.clone(),l=zh(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Me?function(s,o,a,c){if(!Ti(s.precondition,o))return a;let u=zh(s.fieldTransforms,c,o),l=o.data;return l.setAll(Ed(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Ti(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Sy(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=gd(r.transform,i||null);s!=null&&(n===null&&(n=Ae.empty()),n.set(r.field,s))}return n||null}function Bh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Qt(r,i,(s,o)=>Ty(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var bt=class extends cn{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Me=class extends cn{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Ed(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function $h(t,e,n){let r=new Map;W(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,wy(o,a,n[i]))}return r}function zh(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,Ey(s,o,e))}return r}var Ni=class extends cn{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ra=class extends cn{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Pa=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&Ay(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=sr(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=sr(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=fd();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=vd(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(x.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),X())}isEqual(e){return this.batchId===e.batchId&&Qt(this.mutations,e.mutations,(n,r)=>Bh(n,r))&&Qt(this.baseMutations,e.baseMutations,(n,r)=>Bh(n,r))}},Ca=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){W(e.mutations.length===r.length);let i=function(){return gy}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Da=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var V,b;function by(t){switch(t){default:return A();case f.CANCELLED:case f.UNKNOWN:case f.DEADLINE_EXCEEDED:case f.RESOURCE_EXHAUSTED:case f.INTERNAL:case f.UNAVAILABLE:case f.UNAUTHENTICATED:return!1;case f.INVALID_ARGUMENT:case f.NOT_FOUND:case f.ALREADY_EXISTS:case f.PERMISSION_DENIED:case f.FAILED_PRECONDITION:case f.ABORTED:case f.OUT_OF_RANGE:case f.UNIMPLEMENTED:case f.DATA_LOSS:return!0}}function Ry(t){if(t===void 0)return wt("GRPC error has no .code"),f.UNKNOWN;switch(t){case V.OK:return f.OK;case V.CANCELLED:return f.CANCELLED;case V.UNKNOWN:return f.UNKNOWN;case V.DEADLINE_EXCEEDED:return f.DEADLINE_EXCEEDED;case V.RESOURCE_EXHAUSTED:return f.RESOURCE_EXHAUSTED;case V.INTERNAL:return f.INTERNAL;case V.UNAVAILABLE:return f.UNAVAILABLE;case V.UNAUTHENTICATED:return f.UNAUTHENTICATED;case V.INVALID_ARGUMENT:return f.INVALID_ARGUMENT;case V.NOT_FOUND:return f.NOT_FOUND;case V.ALREADY_EXISTS:return f.ALREADY_EXISTS;case V.PERMISSION_DENIED:return f.PERMISSION_DENIED;case V.FAILED_PRECONDITION:return f.FAILED_PRECONDITION;case V.ABORTED:return f.ABORTED;case V.OUT_OF_RANGE:return f.OUT_OF_RANGE;case V.UNIMPLEMENTED:return f.UNIMPLEMENTED;case V.DATA_LOSS:return f.DATA_LOSS;default:return A()}}(b=V||(V={}))[b.OK=0]="OK",b[b.CANCELLED=1]="CANCELLED",b[b.UNKNOWN=2]="UNKNOWN",b[b.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",b[b.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",b[b.NOT_FOUND=5]="NOT_FOUND",b[b.ALREADY_EXISTS=6]="ALREADY_EXISTS",b[b.PERMISSION_DENIED=7]="PERMISSION_DENIED",b[b.UNAUTHENTICATED=16]="UNAUTHENTICATED",b[b.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",b[b.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",b[b.ABORTED=10]="ABORTED",b[b.OUT_OF_RANGE=11]="OUT_OF_RANGE",b[b.UNIMPLEMENTED=12]="UNIMPLEMENTED",b[b.INTERNAL=13]="INTERNAL",b[b.UNAVAILABLE=14]="UNAVAILABLE",b[b.DATA_LOSS=15]="DATA_LOSS";var bE=new Nh([4294967295,4294967295],0);var ka=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function Na(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Py(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Cy(t,e){return Na(t,e.toTimestamp())}function Ht(t){return W(!!t),x.fromTimestamp(function(n){let r=Xe(n);return new Z(r.seconds,r.nanos)}(t))}function wd(t,e){return Oa(t,e).canonicalString()}function Oa(t,e){let n=function(i){return new M(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Dy(t){let e=M.fromString(t);return W(Fy(e)),e}function xa(t,e){return wd(t.databaseId,e.path)}function ky(t){let e=Dy(t);return e.length===4?M.emptyPath():Oy(e)}function Ny(t){return new M(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Oy(t){return W(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function jh(t,e,n){return{name:xa(t,e),fields:n.value.mapValue.fields}}function xy(t,e){let n;if(e instanceof bt)n={update:jh(t,e.key,e.value)};else if(e instanceof Ni)n={delete:xa(t,e.key)};else if(e instanceof Me)n={update:jh(t,e.key,e.data),updateMask:My(e.fieldMask)};else{if(!(e instanceof Ra))return A();n={verify:xa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof on)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof At)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof St)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof an)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw A()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Cy(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:A()}(t,e.precondition)),n}function Vy(t,e){return t&&t.length>0?(W(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ht(i.updateTime):Ht(s);return o.isEqual(x.min())&&(o=Ht(s)),new ba(o,i.transformResults||[])}(n,e))):[]}function Ly(t){let e=ky(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){W(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let p=Td(d);return p instanceof Ze&&sd(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(S){return new nn(Wt(S.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(d){let p;return p=typeof d=="object"?d.value:d,vc(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(d){let p=!!d.before,_=d.values||[];return new tn(_,p)}(n.startAt));let u=null;return n.endAt&&(u=function(d){let p=!d.before,_=d.values||[];return new tn(_,p)}(n.endAt)),uy(e,i,o,s,a,"F",c,u)}function Td(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Wt(n.unaryFilter.field);return G.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Wt(n.unaryFilter.field);return G.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Wt(n.unaryFilter.field);return G.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Wt(n.unaryFilter.field);return G.create(o,"!=",{nullValue:"NULL_VALUE"});default:return A()}}(t):t.fieldFilter!==void 0?function(n){return G.create(Wt(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return A()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ze.create(n.compositeFilter.filters.map(r=>Td(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return A()}}(n.compositeFilter.op))}(t):A()}function Wt(t){return oe.fromServerFormat(t.fieldPath)}function My(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Fy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Va=class{constructor(e){this.ut=e}};function Uy(t){let e=Ly({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sa(e,e.limit,"L"):e}var Oi=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(q(e.integerValue));else if("doubleValue"in e){let r=q(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),or(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"&&(r=Xe(r)),n.dt(`${r.seconds||""}`),n.Et(r.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(Jt(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?nd(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):A()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),w.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};Oi.St=new Oi;var La=class{constructor(){this.on=new Ma}addToCollectionParentIndex(e,n){return this.on.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}deleteAllFieldIndexes(e){return m.resolve()}createTargetIndexes(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(Tt.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(Tt.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}},Ma=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new re(M.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new re(M.comparator)).toArray()}};var RE=new Uint8Array(0);var Te=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Te.DEFAULT_COLLECTION_PERCENTILE=10,Te.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Te.DEFAULT=new Te(41943040,Te.DEFAULT_COLLECTION_PERCENTILE,Te.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Te.DISABLED=new Te(-1,0,0);var cr=class t{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new t(0)}static Nn(){return new t(-1)}};var Fa=class{constructor(){this.changes=new et(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ua=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var qa=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&sr(r.mutation,i,Se.empty(),Z.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,X()).next(()=>r))}getLocalViewOfDocuments(e,n,r=X()){let i=yt();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=vi();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=yt();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,X()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=ki(),o=ir(),a=function(){return ir()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof Me)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),sr(l.mutation,u,l.mutation.getFieldMask(),Z.now())):o.set(u.key,Se.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var d;return a.set(u,new Ua(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=ir(),i=new ae((o,a)=>o-a),s=X();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||Se.empty();l=a.applyToLocalView(u,l),r.set(c,l);let d=(i.get(a.batchId)||X()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,d=fd();l.forEach(p=>{if(!s.has(p)){let _=vd(n.get(p),r.get(p));_!==null&&d.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return w.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):hy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):m.resolve(yt()),a=-1,c=s;return o.next(u=>m.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?m.resolve():this.remoteDocumentCache.getEntry(e,l).next(p=>{c=c.insert(l,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,X())).next(l=>({batchId:a,changes:dd(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new w(n)).next(r=>{let i=vi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=vi();return this.indexManager.getCollectionParents(e,s).next(a=>m.forEach(a,c=>{let u=function(d,p){return new rn(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,en.newInvalidDocument(l)))});let a=vi();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&sr(l.mutation,u,Se.empty(),Z.now()),Sc(n,u)&&(a=a.insert(c,u))}),a})}};var Ba=class{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return m.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ht(i.createTime)}}(n)),m.resolve()}getNamedQuery(e,n){return m.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:Uy(i.bundledQuery),readTime:Ht(i.readTime)}}(n)),m.resolve()}};var $a=class{constructor(){this.overlays=new ae(w.comparator),this.lr=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){let r=yt();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),m.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){let i=yt(),s=n.length+1,o=new w(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return m.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ae((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=yt(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=yt(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return m.resolve(a)}lt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Da(n,r));let s=this.lr.get(n);s===void 0&&(s=X(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}};var ur=class{constructor(){this.hr=new re(L.Pr),this.Ir=new re(L.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){let r=new L(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new L(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){let n=new w(new M([])),r=new L(n,e),i=new L(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){let n=new w(new M([])),r=new L(n,e),i=new L(n,e+1),s=X();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new L(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},L=class{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return w.comparator(e.key,n.key)||D(e.gr,n.gr)}static Tr(e,n){return D(e.gr,n.gr)||w.comparator(e.key,n.key)}};var za=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new re(L.Pr)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Pa(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.yr=this.yr.add(new L(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Sr(r),s=i<0?0:i;return m.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new L(n,0),i=new L(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{let a=this.wr(o.gr);s.push(a)}),m.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new re(D);return n.forEach(i=>{let s=new L(i,0),o=new L(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),m.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;w.isDocumentKey(s)||(s=s.child(""));let o=new L(new w(s),0),a=new re(D);return this.yr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.gr)),!0)},o),m.resolve(this.br(a))}br(e){let n=[];return e.forEach(r=>{let i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){W(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return m.forEach(n.mutations,i=>{let s=new L(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){let r=new L(n,0),i=this.yr.firstAfterOrEqual(r);return m.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){let n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var ja=class{constructor(e){this.Cr=e,this.docs=function(){return new ae(w.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():en.newInvalidDocument(n))}getEntries(e,n){let r=ki();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():en.newInvalidDocument(i))}),m.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=ki(),o=n.path,a=new w(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||X_(Y_(l),r)<=0||(i.has(l.key)||Sc(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,i){A()}vr(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Ga(this)}getSize(e){return m.resolve(this.size)}},Ga=class extends Fa{constructor(e){super(),this._r=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}};var Wa=class{constructor(e){this.persistence=e,this.Fr=new et(n=>Tc(n),Ac),this.lastRemoteSnapshotVersion=x.min(),this.highestTargetId=0,this.Mr=0,this.Or=new ur,this.targetCount=0,this.Nr=cr.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),m.resolve()}kn(e){this.Fr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Nr=new cr(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.kn(n),m.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),m.waitFor(s).next(()=>i)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){let r=this.Fr.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),m.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),m.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Or.mr(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Or.containsKey(n))}};var Ka=class{constructor(e,n){this.Lr={},this.overlays={},this.Br=new ty(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new Wa(this),this.indexManager=new La,this.remoteDocumentCache=function(i){return new ja(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new Va(n),this.Kr=new Ba(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new $a,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new za(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){y("MemoryPersistence","Starting transaction:",e);let i=new Ha(this.Br.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return m.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},Ha=class extends la{constructor(e){super(),this.currentSequenceNumber=e}},Qa=class t{constructor(e){this.persistence=e,this.Gr=new ur,this.zr=null}static jr(e){return new t(e)}get Hr(){if(this.zr)return this.zr;throw A()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),m.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Hr,r=>{let i=w.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,x.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return m.or([()=>m.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}};var Ja=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=X(),i=X();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Ya=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Xa=class{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=function(){return Kc()?8:ey(F())>0?6:4}()}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Ya;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(er()<=T.DEBUG&&y("QueryEngine","SDK will not create cache indexes for query:",tr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),m.resolve()):(er()<=T.DEBUG&&y("QueryEngine","Query:",tr(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(er()<=T.DEBUG&&y("QueryEngine","The SDK decides to create cache indexes for query:",tr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,It(n))):m.resolve())}zi(e,n){if(Uh(n))return m.resolve(null);let r=It(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Sa(n,null,"F"),r=It(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=X(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Yi(n,a);return this.Zi(n,u,o,c.readTime)?this.zi(e,Sa(n,null,"F")):this.Xi(e,u,n,c)}))})))}ji(e,n,r,i){return Uh(n)||i.isEqual(x.min())?m.resolve(null):this.Gi.getDocuments(e,r).next(s=>{let o=this.Yi(n,s);return this.Zi(n,o,r,i)?m.resolve(null):(er()<=T.DEBUG&&y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),tr(n)),this.Xi(e,o,n,J_(i,-1)).next(a=>a))})}Yi(e,n){let r=new re(fy(e));return n.forEach((i,s)=>{Sc(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return er()<=T.DEBUG&&y("QueryEngine","Using full collection scan to execute query:",tr(n)),this.Gi.getDocumentsMatchingQuery(e,n,Tt.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Za=class{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new ae(D),this.ns=new et(s=>Tc(s),Ac),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qa(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}};function qy(t,e,n,r){return new Za(t,e,n,r)}function Ad(t,e){return h(this,null,function*(){let n=N(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=X();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({_s:u,removedBatchIds:o,addedBatchIds:a}))})})})}function By(t,e){let n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let d=u.batch,p=d.keys(),_=m.resolve();return p.forEach(S=>{_=_.next(()=>l.getEntry(c,S)).next(C=>{let R=u.docVersions.get(S);W(R!==null),C.version.compareTo(R)<0&&(d.applyToRemoteDocument(C,u),C.isValidDocument()&&(C.setReadTime(u.commitVersion),l.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=X();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function $y(t){let e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function zy(t,e){let n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var xi=class{constructor(){this.activeTargetIds=Iy()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ec=class{constructor(){this.eo=new xi,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new xi,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var tc=class{ro(e){}shutdown(){}};var Vi=class{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ao)e(0)}_o(){y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ei=null;function Zo(){return Ei===null?Ei=function(){return 268435456+Math.round(2147483648*Math.random())}():Ei++,"0x"+Ei.toString(16)}var jy={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var nc=class{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}};var Y="WebChannelConnection",rc=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.yo=r+"://"+n.host,this.wo=`projects/${i}/databases/${s}`,this.So=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get bo(){return!1}Do(n,r,i,s,o){let a=Zo(),c=this.Co(n,r.toUriEncodedString());y("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(u,s,o),this.Fo(n,c,u,i).then(l=>(y("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Ai("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}Mo(n,r,i,s,o,a){return this.Do(n,r,i,s,o)}vo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ln}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}Co(n,r){let i=jy[n];return`${this.yo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,n,r,i){let s=Zo();return new Promise((o,a)=>{let c=new kh;c.setWithCredentials(!0),c.listenOnce(Ph.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case yi.NO_ERROR:let l=c.getResponseJson();y(Y,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case yi.TIMEOUT:y(Y,`RPC '${e}' ${s} timed out`),a(new I(f.DEADLINE_EXCEEDED,"Request time out"));break;case yi.HTTP_ERROR:let d=c.getStatus();if(y(Y,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let S=function(R){let B=R.toLowerCase().replace(/_/g,"-");return Object.values(f).indexOf(B)>=0?B:f.UNKNOWN}(_.status);a(new I(S,_.message))}else a(new I(f.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new I(f.UNAVAILABLE,"Connection failed."));break;default:A()}}finally{y(Y,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);y(Y,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}xo(e,n,r){let i=Zo(),s=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=bh(),a=Rh(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new Dh({})),this.vo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");y(Y,`Creating RPC '${e}' stream ${i}: ${l}`,c);let d=o.createWebChannel(l,c),p=!1,_=!1,S=new nc({co:R=>{_?y(Y,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(y(Y,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),y(Y,`RPC '${e}' stream ${i} sending:`,R),d.send(R))},lo:()=>d.close()}),C=(R,B,ee)=>{R.listen(B,ce=>{try{ee(ce)}catch(ge){setTimeout(()=>{throw ge},0)}})};return C(d,Zn.EventType.OPEN,()=>{_||(y(Y,`RPC '${e}' stream ${i} transport opened.`),S.Vo())}),C(d,Zn.EventType.CLOSE,()=>{_||(_=!0,y(Y,`RPC '${e}' stream ${i} transport closed`),S.fo())}),C(d,Zn.EventType.ERROR,R=>{_||(_=!0,Ai(Y,`RPC '${e}' stream ${i} transport errored:`,R),S.fo(new I(f.UNAVAILABLE,"The operation could not be completed")))}),C(d,Zn.EventType.MESSAGE,R=>{var B;if(!_){let ee=R.data[0];W(!!ee);let ce=ee,ge=ce.error||((B=ce[0])===null||B===void 0?void 0:B.error);if(ge){y(Y,`RPC '${e}' stream ${i} received error:`,ge);let hn=ge.status,nt=function(fn){let pr=V[fn];if(pr!==void 0)return Ry(pr)}(hn),dn=ge.message;nt===void 0&&(nt=f.INTERNAL,dn="Unknown error status: "+hn+" with message "+ge.message),_=!0,S.fo(new I(nt,dn)),d.close()}else y(Y,`RPC '${e}' stream ${i} received:`,ee),S.po(ee)}}),C(a,Ch.STAT_EVENT,R=>{R.stat===Xo.PROXY?y(Y,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Xo.NOPROXY&&y(Y,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.mo()},0),S}};function ea(){return typeof document<"u"?document:null}function Wi(t){return new ka(t,!0)}var Li=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Oo=r,this.No=i,this.Lo=s,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();let n=Math.floor(this.Bo+this.$o()),r=Math.max(0,Date.now()-this.qo),i=Math.max(0,n-r);i>0&&y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Bo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){this.ko!==null&&(this.ko.skipDelay(),this.ko=null)}cancel(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}};var ic=class{constructor(e,n,r,i,s,o,a,c){this.si=e,this.Wo=r,this.Go=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new Li(e,n)}Yo(){return this.state===1||this.state===5||this.Zo()}Zo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Xo()}stop(){return h(this,null,function*(){this.Yo()&&(yield this.close(0))})}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&this.jo===null&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,()=>this.n_()))}r_(e){this.i_(),this.stream.send(e)}n_(){return h(this,null,function*(){if(this.Zo())return this.close(0)})}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}close(e,n){return h(this,null,function*(){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,e!==4?this.Jo.reset():n&&n.code===f.RESOURCE_EXHAUSTED?(wt(n.toString()),wt("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):n&&n.code===f.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Eo(n)})}o_(){}auth(){this.state=1;let e=this.__(this.zo),n=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.zo===n&&this.a_(r,i)},r=>{e(()=>{let i=new I(f.UNKNOWN,"Fetching auth token failed: "+r.message);return this.u_(i)})})}a_(e,n){let r=this.__(this.zo);this.stream=this.c_(e,n),this.stream.ho(()=>{r(()=>this.listener.ho())}),this.stream.Io(()=>{r(()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,()=>(this.Zo()&&(this.state=3),Promise.resolve())),this.listener.Io()))}),this.stream.Eo(i=>{r(()=>this.u_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Xo(){this.state=5,this.Jo.Ko(()=>h(this,null,function*(){this.state=0,this.start()}))}u_(e){return y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return n=>{this.si.enqueueAndForget(()=>this.zo===e?n():(y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var sc=class extends ic{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,n){return this.connection.xo("Write",e,n)}onMessage(e){if(W(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();let n=Vy(e.writeResults,e.commitTime),r=Ht(e.commitTime);return this.listener.d_(r,n)}return W(!e.writeResults||e.writeResults.length===0),this.I_=!0,this.listener.A_()}R_(){let e={};e.database=Ny(this.serializer),this.r_(e)}E_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>xy(this.serializer,r))};this.r_(n)}};var oc=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.V_=!1}m_(){if(this.V_)throw new I(f.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,n,r,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Do(e,Oa(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===f.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new I(f.UNKNOWN,s.toString())})}Mo(e,n,r,i,s){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Oa(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===f.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new I(f.UNKNOWN,o.toString())})}terminate(){this.V_=!0,this.connection.terminate()}};var ac=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(wt(n),this.y_=!1):y("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var cc=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.ro(o=>{r.enqueueAndForget(()=>h(this,null,function*(){dr(this)&&(y("RemoteStore","Restarting streams for network reachability change."),yield function(c){return h(this,null,function*(){let u=N(c);u.M_.add(4),yield hr(u),u.N_.set("Unknown"),u.M_.delete(4),yield Ki(u)})}(this))}))}),this.N_=new ac(r,i)}};function Ki(t){return h(this,null,function*(){if(dr(t))for(let e of t.x_)yield e(!0)})}function hr(t){return h(this,null,function*(){for(let e of t.x_)yield e(!1)})}function dr(t){return N(t).M_.size===0}function Sd(t,e,n){return h(this,null,function*(){if(!Gi(e))throw e;t.M_.add(1),yield hr(t),t.N_.set("Offline"),n||(n=()=>$y(t.localStore)),t.asyncQueue.enqueueRetryable(()=>h(this,null,function*(){y("RemoteStore","Retrying IndexedDB access"),yield n(),t.M_.delete(1),yield Ki(t)}))})}function bd(t,e){return e().catch(n=>Sd(t,n,e))}function Hi(t){return h(this,null,function*(){let e=N(t),n=tt(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;Gy(e);)try{let i=yield zy(e.localStore,r);if(i===null){e.v_.length===0&&n.t_();break}r=i.batchId,Wy(e,i)}catch(i){yield Sd(e,i)}Rd(e)&&Pd(e)})}function Gy(t){return dr(t)&&t.v_.length<10}function Wy(t,e){t.v_.push(e);let n=tt(t);n.Zo()&&n.T_&&n.E_(e.mutations)}function Rd(t){return dr(t)&&!tt(t).Yo()&&t.v_.length>0}function Pd(t){tt(t).start()}function Ky(t){return h(this,null,function*(){tt(t).R_()})}function Hy(t){return h(this,null,function*(){let e=tt(t);for(let n of t.v_)e.E_(n.mutations)})}function Qy(t,e,n){return h(this,null,function*(){let r=t.v_.shift(),i=Ca.from(r,e,n);yield bd(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Hi(t)})}function Jy(t,e){return h(this,null,function*(){e&&tt(t).T_&&(yield function(r,i){return h(this,null,function*(){if(function(o){return by(o)&&o!==f.ABORTED}(i.code)){let s=r.v_.shift();tt(r).e_(),yield bd(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Hi(r)}})}(t,e)),Rd(t)&&Pd(t)})}function Gh(t,e){return h(this,null,function*(){let n=N(t);n.asyncQueue.verifyOperationInProgress(),y("RemoteStore","RemoteStore received new credentials");let r=dr(n);n.M_.add(3),yield hr(n),r&&n.N_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),yield Ki(n)})}function Yy(t,e){return h(this,null,function*(){let n=N(t);e?(n.M_.delete(2),yield Ki(n)):e||(n.M_.add(2),yield hr(n),n.N_.set("Unknown"))})}function tt(t){return t.k_||(t.k_=function(n,r,i){let s=N(n);return s.m_(),new sc(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:()=>Promise.resolve(),Io:Ky.bind(null,t),Eo:Jy.bind(null,t),A_:Hy.bind(null,t),d_:Qy.bind(null,t)}),t.x_.push(e=>h(this,null,function*(){e?(t.k_.e_(),yield Hi(t)):(yield t.k_.stop(),t.v_.length>0&&(y("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))}))),t.k_}var uc=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ve,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(f.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Cd(t,e){if(wt("AsyncQueue",`${e}: ${t}`),Gi(t))return new I(f.UNAVAILABLE,`${e}: ${t}`);throw t}var lc=class{constructor(){this.queries=new et(e=>ld(e),ud),this.onlineState="Unknown",this.z_=new Set}};function Xy(t){t.z_.forEach(e=>{e.next()})}var Wh,Kh;(Kh=Wh||(Wh={})).J_="default",Kh.Cache="cache";var hc=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new et(a=>ld(a),ud),this.Da=new Map,this.Ca=new Set,this.va=new ae(w.comparator),this.Fa=new Map,this.Ma=new ur,this.xa={},this.Oa=new Map,this.Na=cr.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function Zy(t,e,n){return h(this,null,function*(){let r=rI(t);try{let i=yield function(o,a){let c=N(o),u=Z.now(),l=a.reduce((_,S)=>_.add(S.key),X()),d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let S=ki(),C=X();return c.ss.getEntries(_,l).next(R=>{S=R,S.forEach((B,ee)=>{ee.isValidDocument()||(C=C.add(B))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,S)).next(R=>{d=R;let B=[];for(let ee of a){let ce=Sy(ee,d.get(ee.key).overlayedDocument);ce!=null&&B.push(new Me(ee.key,ce,rd(ce.value.mapValue),vt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,u,B,a)}).next(R=>{p=R;let B=R.applyToLocalDocumentSet(d,C);return c.documentOverlayCache.saveOverlays(_,R.batchId,B)})}).then(()=>({batchId:p.batchId,changes:dd(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.xa[o.currentUser.toKey()];u||(u=new ae(D)),u=u.insert(a,c),o.xa[o.currentUser.toKey()]=u}(r,i.batchId,n),yield Qi(r,i.changes),yield Hi(r.remoteStore)}catch(i){let s=Cd(i,"Failed to persist write");n.reject(s)}})}function Hh(t,e,n){let r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=N(o);c.onlineState=a;let u=!1;c.queries.forEach((l,d)=>{for(let p of d.U_)p.j_(a)&&(u=!0)}),u&&Xy(c)}(r.eventManager,e),i.length&&r.Sa.l_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function eI(t,e){return h(this,null,function*(){let n=N(t),r=e.batch.batchId;try{let i=yield By(n.localStore,e);kd(n,r,null),Dd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Qi(n,i)}catch(i){yield Zh(i)}})}function tI(t,e,n){return h(this,null,function*(){let r=N(t);try{let i=yield function(o,a){let c=N(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>(W(d!==null),l=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);kd(r,e,n),Dd(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Qi(r,i)}catch(i){yield Zh(i)}})}function Dd(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function kd(t,e,n){let r=N(t),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Qi(t,e,n){return h(this,null,function*(){let r=N(t),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=Ja.Qi(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.Sa.l_(i),yield function(c,u){return h(this,null,function*(){let l=N(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>m.forEach(u,p=>m.forEach(p.ki,_=>l.persistence.referenceDelegate.addReference(d,p.targetId,_)).next(()=>m.forEach(p.qi,_=>l.persistence.referenceDelegate.removeReference(d,p.targetId,_)))))}catch(d){if(!Gi(d))throw d;y("LocalStore","Failed to update sequence numbers: "+d)}for(let d of u){let p=d.targetId;if(!d.fromCache){let _=l.ts.get(p),S=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(S);l.ts=l.ts.insert(p,C)}}})}(r.localStore,s))})}function nI(t,e){return h(this,null,function*(){let n=N(t);if(!n.currentUser.isEqual(e)){y("SyncEngine","User change. New user:",e.toKey());let r=yield Ad(n.localStore,e);n.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new I(f.CANCELLED,o))})}),s.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Qi(n,r._s)}})}function rI(t){let e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tI.bind(null,e),e}var Mi=class{constructor(){this.synchronizeTabs=!1}initialize(e){return h(this,null,function*(){this.serializer=Wi(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return qy(this.persistence,new Xa,e.initialUser,this.serializer)}createPersistence(e){return new Ka(Qa.jr,this.serializer)}createSharedClientState(e){return new ec}terminate(){return h(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var dc=class{initialize(e,n){return h(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Hh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nI.bind(null,this.syncEngine),yield Yy(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new lc}()}createDatastore(e){let n=Wi(e.databaseInfo.databaseId),r=function(s){return new rc(s)}(e.databaseInfo);return function(s,o,a,c){return new oc(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new cc(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Hh(this.syncEngine,n,0),function(){return Vi.D()?new Vi:new tc}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let d=new hc(i,s,o,a,c,u);return l&&(d.La=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return h(this,null,function*(){var e;yield function(r){return h(this,null,function*(){let i=N(r);y("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield hr(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var fc=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=j.UNAUTHENTICATED,this.clientId=bi.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>h(this,null,function*(){y("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(y("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(f.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ve;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>h(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Cd(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function ta(t,e){return h(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),y("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>h(this,null,function*(){r.isEqual(i)||(yield Ad(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function Qh(t,e){return h(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield sI(t);y("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Gh(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Gh(e.remoteStore,i)),t._onlineComponents=e})}function iI(t){return t.name==="FirebaseError"?t.code===f.FAILED_PRECONDITION||t.code===f.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function sI(t){return h(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){y("FirestoreClient","Using user provided OfflineComponentProvider");try{yield ta(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!iI(n))throw n;Ai("Error using user provided cache. Falling back to memory cache: "+n),yield ta(t,new Mi)}}else y("FirestoreClient","Using default OfflineComponentProvider"),yield ta(t,new Mi);return t._offlineComponents})}function oI(t){return h(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(y("FirestoreClient","Using user provided OnlineComponentProvider"),yield Qh(t,t._uninitializedComponentsProvider._online)):(y("FirestoreClient","Using default OnlineComponentProvider"),yield Qh(t,new dc))),t._onlineComponents})}function aI(t){return oI(t).then(e=>e.syncEngine)}function Nd(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var Jh=new Map;function Od(t,e,n){if(!n)throw new I(f.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cI(t,e,n,r){if(e===!0&&r===!0)throw new I(f.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Yh(t){if(!w.isDocumentKey(t))throw new I(f.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Xh(t){if(w.isDocumentKey(t))throw new I(f.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":A()}function xd(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(f.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=bc(t);throw new I(f.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var Fi=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(f.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(f.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Nd((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new I(f.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new I(f.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new I(f.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},un=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fi({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(f.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(f.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fi(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new na;switch(r.type){case"firstParty":return new oa(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(f.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=Jh.get(n);r&&(y("ComponentProvider","Removing Datastore"),Jh.delete(n),r.terminate())}(this),Promise.resolve()}};function Vd(t,e,n,r={}){var i;let s=(t=xd(t,un))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ai("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=j.MOCK_USER;else{a=$c(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new I(f.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new j(u)}t._authCredentials=new ra(new Si(a,c))}}var pc=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Le=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Je(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Je=class t extends pc{constructor(e,n,r){super(e,n,ly(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new w(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function Ld(t,e,...n){if(t=te(t),Od("collection","path",e),t instanceof un){let r=M.fromString(e,...n);return Xh(r),new Je(t,null,r)}{if(!(t instanceof Le||t instanceof Je))throw new I(f.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(M.fromString(e,...n));return Xh(r),new Je(t.firestore,null,r)}}function Md(t,e,...n){if(t=te(t),arguments.length===1&&(e=bi.newId()),Od("doc","path",e),t instanceof un){let r=M.fromString(e,...n);return Yh(r),new Le(t,null,new w(r))}{if(!(t instanceof Le||t instanceof Je))throw new I(f.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(M.fromString(e,...n));return Yh(r),new Le(t.firestore,t instanceof Je?t.converter:null,new w(r))}}var mc=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new Li(this,"async_queue_retry"),this.hu=()=>{let n=ea();n&&y("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Jo.Uo()};let e=ea();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let n=ea();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let n=new Ve;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return h(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!Gi(e))throw e;y("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko(()=>this.Tu())}})}Iu(e){let n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw wt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);let i=uc.createAndSchedule(this,e,n,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&A()}verifyOperationInProgress(){}du(){return h(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let n=this._u.indexOf(e);this._u.splice(n,1)}};var Ui=class extends un{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new mc}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Ud(this),this._firestoreClient.terminate()}};function Fd(t,e){let n=typeof t=="object"?t:xt(),r=typeof t=="string"?t:e||"(default)",i=In(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Bc("firestore");s&&Vd(i,...s)}return i}function uI(t){return t._firestoreClient||Ud(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ud(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new da(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Nd(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new fc(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var qi=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Ye.fromBase64String(e))}catch(n){throw new I(f.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Ye.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Bi=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(f.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new oe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var $i=class{constructor(e){this._methodName=e}};var zi=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(f.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(f.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return D(this._lat,e._lat)||D(this._long,e._long)}};var lI=/^__.*__$/,gc=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Me(e,this.data,this.fieldMask,n,this.fieldTransforms):new bt(e,this.data,n,this.fieldTransforms)}};function qd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw A()}}var _c=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return ji(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(qd(this.fu)&&lI.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},yc=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Wi(e)}Fu(e,n,r,i=!1){return new _c({fu:e,methodName:n,vu:r,path:oe.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function hI(t){let e=t._freezeSettings(),n=Wi(t._databaseId);return new yc(t._databaseId,!!e.ignoreUndefinedProperties,n)}function dI(t,e,n,r,i,s={}){let o=t.Fu(s.merge||s.mergeFields?2:0,e,n,i);jd("Data must be an object, but it was:",o,r);let a=$d(r,o),c,u;if(s.merge)c=new Se(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let p=fI(e,d,n);if(!o.contains(p))throw new I(f.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);gI(l,p)||l.push(p)}c=new Se(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new gc(new Ae(a),c,u)}function Bd(t,e){if(zd(t=te(t)))return jd("Unsupported field value:",e,t),$d(t,e);if(t instanceof $i)return function(r,i){if(!qd(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Bd(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=te(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vy(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Z.fromDate(r);return{timestampValue:Na(i.serializer,s)}}if(r instanceof Z){let s=new Z(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Na(i.serializer,s)}}if(r instanceof zi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof qi)return{bytesValue:Py(i.serializer,r._byteString)};if(r instanceof Le){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wd(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${bc(r)}`)}(t,e)}function $d(t,e){let n={};return ed(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lr(t,(r,i)=>{let s=Bd(i,e.pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function zd(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Z||t instanceof zi||t instanceof qi||t instanceof Le||t instanceof $i)}function jd(t,e,n){if(!zd(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=bc(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function fI(t,e,n){if((e=te(e))instanceof Bi)return e._internalPath;if(typeof e=="string")return mI(t,e);throw ji("Field path arguments must be of type string or ",t,!1,void 0,n)}var pI=new RegExp("[~\\*/\\[\\]]");function mI(t,e,n){if(e.search(pI)>=0)throw ji(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Bi(...e.split("."))._internalPath}catch{throw ji(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ji(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new I(f.INVALID_ARGUMENT,a+t+c)}function gI(t,e){return t.some(n=>n.isEqual(e))}function _I(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function Gd(t,e){let n=xd(t.firestore,Ui),r=Md(t),i=_I(t.converter,e);return yI(n,[dI(hI(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,vt.exists(!1))]).then(()=>r)}function yI(t,e){return function(r,i){let s=new Ve;return r.asyncQueue.enqueueAndForget(()=>h(this,null,function*(){return Zy(yield aI(r),i,s)})),s.promise}(uI(t),e)}(function(e,n=!0){(function(i){ln=i})(ze),$e(new le("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ui(new ia(r.getProvider("auth-internal")),new ca(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new I(f.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fa(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),U(Oh,"4.6.1",e),U(Oh,"4.6.1","esm2017")})();var fr=class{constructor(e){return e}},Wd="firestore",Rc=class{constructor(){return vn(Wd)}};var Pc=new Pt("angularfire2.firestore-instances");function II(t,e){let n=Tr(Wd,t,e);return n&&new fr(n)}function vI(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new fr(r)}}var EI={provide:Rc,deps:[[new ue,Pc]]},wI={provide:fr,useFactory:II,deps:[[new ue,Pc],Ce]},TI=(()=>{class t{constructor(){U("angularfire",at.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Dt({type:t});static \u0275inj=Rt({providers:[wI,EI]})}return t})();function Jw(t,...e){return{ngModule:TI,providers:[{provide:Pc,useFactory:vI(t),multi:!0,deps:[Ue,kt,Mt,ct,[new ue,Dn],[new ue,Lt],...e]}]}}var Yw=he(Gd,!0);var Xw=he(Ld,!0);var Zw=he(Fd,!0);var rT=(()=>{let e=class e{constructor(r){this.auth=r}login(r,i){return ul(this.auth,r,i)}registro(r,i){return cl(this.auth,r,i)}logOut(){return ll(this.auth)}getEmailLogeado(){return JSON.parse(localStorage.getItem("email"))}};e.\u0275fac=function(i){return new(i||e)(Ct(ft))},e.\u0275prov=mr({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{cv as a,uv as b,ft as c,lE as d,hE as e,dE as f,fr as g,Jw as h,Yw as i,Xw as j,Zw as k,rT as l};
